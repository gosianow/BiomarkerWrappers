<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Exploratory biomarker analysis â€¢ BiomarkerWrappers</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Exploratory biomarker analysis">
<meta property="og:description" content="BiomarkerWrappers">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BiomarkerWrappers</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.35</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Differential_Gene_Expression.html">Differential gene expression</a>
    </li>
    <li>
      <a href="../articles/Exploratory_Biomarker_Analysis.html">Exploratory biomarker analysis</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Exploratory_Biomarker_Analysis_files/header-attrs-2.11/header-attrs.js"></script><script src="Exploratory_Biomarker_Analysis_files/kePrint-0.0.1/kePrint.js"></script><link href="Exploratory_Biomarker_Analysis_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Exploratory biomarker analysis</h1>
                        <h4 class="author">Malgorzata Nowicka</h4>
            
            <h4 class="date">2022-04-03</h4>
      
      
      <div class="hidden name"><code>Exploratory_Biomarker_Analysis.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### Packages to compile rmarkdown</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/">knitr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/rmarkdown">rmarkdown</a></span><span class="op">)</span>
<span class="co">### Packages for nice tables</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span>


<span class="va">font_size</span> <span class="op">&lt;-</span> <span class="fl">9</span>
<span class="va">cache</span> <span class="op">&lt;-</span> <span class="fl">0</span>


<span class="co">### Set global option for font_size for bkable in this document </span>

<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>bkable_font_size <span class="op">=</span> <span class="va">font_size</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>bkable_full_width <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>


<span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>cache <span class="op">=</span> <span class="va">cache</span>, cache.comments <span class="op">=</span> <span class="cn">FALSE</span>, echo <span class="op">=</span> <span class="cn">TRUE</span>, warning <span class="op">=</span> <span class="cn">FALSE</span>, message <span class="op">=</span> <span class="cn">FALSE</span>, error <span class="op">=</span> <span class="cn">FALSE</span>, fig.width <span class="op">=</span> <span class="fl">6</span>, fig.height <span class="op">=</span> <span class="fl">5</span>, fig.align <span class="op">=</span> <span class="st">"center"</span>, tidy<span class="op">=</span><span class="cn">TRUE</span>, tidy.opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>width.cutoff <span class="op">=</span> <span class="fl">80</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html">theme_set</a></span><span class="op">(</span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/theme_cowplot.html">theme_cowplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>


<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">BiomarkerWrappers</span><span class="op">)</span></code></pre></div>
<div id="load-data" class="section level1">
<h1 class="hasAnchor">
<a href="#load-data" class="anchor"></a>Load data</h1>
<p><code>bdata</code> object contains random survival and biomarker data. It is not expected to observe any biologically meaningful associations. The goal for this data sets is to solely demonstrate the functionality of this package.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">bdata</span><span class="op">)</span>



<span class="co">### Dichotomize gene expression into low and high</span>

<span class="va">genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BCL2"</span>, <span class="st">"GeneA"</span>, <span class="st">"GeneB"</span>, <span class="st">"GeneC"</span>, <span class="st">"GeneD"</span><span class="op">)</span>

<span class="va">data_cat2</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_all</a></span><span class="op">(</span><span class="va">bdata</span><span class="op">[</span>, <span class="va">genes</span><span class="op">]</span>, <span class="va">wrapper_cut_2groups</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data_cat2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">genes</span>, <span class="st">"_cat2"</span><span class="op">)</span>


<span class="co">### Stratify gene expression into quartiles</span>

<span class="va">data_cat4</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_all</a></span><span class="op">(</span><span class="va">bdata</span><span class="op">[</span>, <span class="va">genes</span><span class="op">]</span>, <span class="va">wrapper_cut_quartiles</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data_cat4</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">genes</span>, <span class="st">"_cat4"</span><span class="op">)</span>


<span class="va">bdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/limma/man/cbind.html">cbind</a></span><span class="op">(</span><span class="va">bdata</span>, <span class="va">data_cat2</span>, <span class="va">data_cat4</span><span class="op">)</span></code></pre></div>
<div id="define-variable-names" class="section level2">
<h2 class="hasAnchor">
<a href="#define-variable-names" class="anchor"></a>Define variable names</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">variable_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/format_variable_names.html">format_variable_names</a></span><span class="op">(</span><span class="va">bdata</span><span class="op">)</span>

<span class="va">variable_names</span></code></pre></div>
<pre><code>##          Patient_ID                 Age                 Sex                 IPI 
##        "Patient ID"               "Age"               "Sex"               "IPI" 
##   Geographic_Region       Treatment_Arm                 PFS           PFS_Event 
## "Geographic Region"     "Treatment Arm"               "PFS"         "PFS Event" 
##            Response      Cell_Of_Origin         BCL2_by_IHC        BCL2_by_FISH 
##          "Response"    "Cell Of Origin"       "BCL2 by IHC"      "BCL2 by FISH" 
##                BCL2               GeneA               GeneB               GeneC 
##              "BCL2"             "GeneA"             "GeneB"             "GeneC" 
##               GeneD          BEP_RNAseq                 ORR           BCL2_cat2 
##             "GeneD"        "BEP RNAseq"               "ORR"         "BCL2 cat2" 
##          GeneA_cat2          GeneB_cat2          GeneC_cat2          GeneD_cat2 
##        "GeneA cat2"        "GeneB cat2"        "GeneC cat2"        "GeneD cat2" 
##           BCL2_cat4          GeneA_cat4          GeneB_cat4          GeneC_cat4 
##         "BCL2 cat4"        "GeneA cat4"        "GeneB cat4"        "GeneC cat4" 
##          GeneD_cat4 
##        "GeneD cat4"</code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### Adjust variable names</span>

<span class="va">variable_names</span><span class="op">[[</span><span class="st">"GeneA_cat2"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Gene A stratified by median"</span></code></pre></div>
</div>
</div>
<div id="tile-plot" class="section level1">
<h1 class="hasAnchor">
<a href="#tile-plot" class="anchor"></a>Tile plot</h1>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### Plot generated using geom_tile</span>

<span class="fu"><a href="../reference/wrapper_tile_plot1_core.html">wrapper_tile_plot1_core</a></span><span class="op">(</span><span class="va">bdata</span>, y_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BCL2_by_IHC"</span>, <span class="st">"BCL2_by_FISH"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/unnamed-chunk-2-1.png" width="960" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\n\n ------ \n\n"</span><span class="op">)</span></code></pre></div>
<hr>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### Plot generated using geom_col. It has substantially smaller size when</span>
<span class="co">### sample size is large.</span>

<span class="fu"><a href="../reference/wrapper_tile_plot1_core.html">wrapper_tile_plot2_core</a></span><span class="op">(</span><span class="va">bdata</span>, y_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BCL2_by_IHC"</span>, <span class="st">"BCL2_by_FISH"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/unnamed-chunk-2-2.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div id="cox-regression" class="section level1">
<h1 class="hasAnchor">
<a href="#cox-regression" class="anchor"></a>Cox regression</h1>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### Biomarker effect</span>

<span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span>
<span class="va">tte_var</span> <span class="op">&lt;-</span> <span class="st">"PFS"</span>
<span class="va">censor_var</span> <span class="op">&lt;-</span> <span class="st">"PFS_Event"</span>

<span class="va">biomarker_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"GeneA_cat2"</span>, <span class="st">"GeneA"</span><span class="op">)</span>
<span class="va">adjustment_vars</span> <span class="op">&lt;-</span> <span class="st">"IPI"</span>

<span class="va">treatment_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span>


<span class="fu"><a href="../reference/wrapper_cox_regression_biomarker.html">wrapper_cox_regression_biomarker</a></span><span class="op">(</span><span class="va">data</span>, tte_var <span class="op">=</span> <span class="va">tte_var</span>, censor_var <span class="op">=</span> <span class="va">censor_var</span>,
    biomarker_vars <span class="op">=</span> <span class="va">biomarker_vars</span>, adjustment_vars <span class="op">=</span> <span class="va">adjustment_vars</span>, treatment_var <span class="op">=</span> <span class="va">treatment_var</span><span class="op">)</span></code></pre></div>
<table class="table table table-condensed table-bordered">
<caption style="font-size: initial !important;">
Biomarker effect on PFS. Adjusted, unstratified analysis. Cox regression model includes the biomarker and IPI.
</caption>
<thead><tr>
<th style="text-align:left;">
Treatment Arm
</th>
<th style="text-align:left;">
Biomarker
</th>
<th style="text-align:left;">
Subgroup
</th>
<th style="text-align:left;">
Total N
</th>
<th style="text-align:left;">
Total Events
</th>
<th style="text-align:left;">
N
</th>
<th style="text-align:left;">
Events
</th>
<th style="text-align:left;">
MST
</th>
<th style="text-align:left;">
MST 95% CI
</th>
<th style="text-align:left;">
HR
</th>
<th style="text-align:left;">
HR 95% CI
</th>
<th style="text-align:left;">
P-value
</th>
<th style="text-align:left;">
Adj. P-value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
CTRL
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
low
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
204
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
85
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
104
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
41 (39.4%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
NA
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(76.9 - NA)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
high
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
204
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
85
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
100
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
44 (44.0%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
83.1
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(82.1 - NA)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
1.00
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(0.65 - 1.55)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.9828
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.9828
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
TRT
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
low
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
196
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
83
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
96
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
40 (41.7%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
99.9
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(82.2 - NA)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
high
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
196
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
83
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
100
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
43 (43.0%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
&gt;100.0
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(81.6 - NA)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.91
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(0.59 - 1.41)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.6827
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.9828
</td>
</tr>
<tr>
<td style="text-align:left;">
CTRL
</td>
<td style="text-align:left;">
GeneA
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
204
</td>
<td style="text-align:left;">
85
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;font-weight: bold;">
1.06
</td>
<td style="text-align:left;">
(0.86 - 1.31)
</td>
<td style="text-align:left;font-weight: bold;">
0.5723
</td>
<td style="text-align:left;font-weight: bold;">
0.9828
</td>
</tr>
<tr>
<td style="text-align:left;">
TRT
</td>
<td style="text-align:left;">
GeneA
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
196
</td>
<td style="text-align:left;">
83
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;font-weight: bold;">
1.03
</td>
<td style="text-align:left;">
(0.82 - 1.29)
</td>
<td style="text-align:left;font-weight: bold;">
0.8129
</td>
<td style="text-align:left;font-weight: bold;">
0.9828
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## To represent the results with a forest plot</span>

<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wrapper_cox_regression_biomarker.html">wrapper_cox_regression_biomarker</a></span><span class="op">(</span><span class="va">data</span>, tte_var <span class="op">=</span> <span class="va">tte_var</span>, censor_var <span class="op">=</span> <span class="va">censor_var</span>,
    biomarker_vars <span class="op">=</span> <span class="va">biomarker_vars</span>, adjustment_vars <span class="op">=</span> <span class="va">adjustment_vars</span>, treatment_var <span class="op">=</span> <span class="va">treatment_var</span>,
    print_total <span class="op">=</span> <span class="cn">FALSE</span>, print_adjpvalues <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="fu"><a href="../reference/Bclass-class.html">bforest</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/cox_regression-1.png" width="1920" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### Treatment effect within biomarker subgroups</span>

<span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span>
<span class="va">tte_var</span> <span class="op">&lt;-</span> <span class="st">"PFS"</span>
<span class="va">censor_var</span> <span class="op">&lt;-</span> <span class="st">"PFS_Event"</span>

<span class="va">treatment_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span>
<span class="va">biomarker_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"GeneA_cat2"</span>, <span class="st">"GeneB_cat2"</span><span class="op">)</span>
<span class="va">adjustment_vars</span> <span class="op">&lt;-</span> <span class="st">"IPI"</span>


<span class="fu"><a href="../reference/wrapper_cox_regression_treatment.html">wrapper_cox_regression_treatment</a></span><span class="op">(</span><span class="va">data</span>, tte_var <span class="op">=</span> <span class="va">tte_var</span>, censor_var <span class="op">=</span> <span class="va">censor_var</span>,
    treatment_var <span class="op">=</span> <span class="va">treatment_var</span>, biomarker_vars <span class="op">=</span> <span class="va">biomarker_vars</span>, adjustment_vars <span class="op">=</span> <span class="va">adjustment_vars</span><span class="op">)</span></code></pre></div>
<table class="table table table-condensed table-bordered">
<caption style="font-size: initial !important;">
Treatment effect on PFS. Adjusted, unstratified analysis. Cox regression model includes the treatment and IPI.
</caption>
<thead><tr>
<th style="text-align:left;">
Biomarker
</th>
<th style="text-align:left;">
Biomarker Subgroup
</th>
<th style="text-align:left;">
Treatment Subgroup
</th>
<th style="text-align:left;">
Total N
</th>
<th style="text-align:left;">
Total Events
</th>
<th style="text-align:left;">
N
</th>
<th style="text-align:left;">
Events
</th>
<th style="text-align:left;">
MST
</th>
<th style="text-align:left;">
MST 95% CI
</th>
<th style="text-align:left;">
HR
</th>
<th style="text-align:left;">
HR 95% CI
</th>
<th style="text-align:left;">
P-value
</th>
<th style="text-align:left;">
Adj. P-value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
low
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
CTRL
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
200
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
81
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
104
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
41 (39.4%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
NA
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(76.9 - NA)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
TRT
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
200
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
81
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
96
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
40 (41.7%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
99.9
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(82.2 - NA)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.83
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(0.53 - 1.30)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.4156
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.5541
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
high
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
CTRL
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
200
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
87
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
100
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
44 (44.0%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
83.1
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(82.1 - NA)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
TRT
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
200
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
87
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
100
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
43 (43.0%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
&gt;100.0
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(81.6 - NA)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.75
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(0.49 - 1.15)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.1917
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.3835
</td>
</tr>
<tr>
<td style="text-align:left;">
GeneB cat2
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
CTRL
</td>
<td style="text-align:left;">
200
</td>
<td style="text-align:left;">
73
</td>
<td style="text-align:left;">
96
</td>
<td style="text-align:left;">
35 (36.5%)
</td>
<td style="text-align:left;">
98.3
</td>
<td style="text-align:left;">
(82.6 - NA)
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
TRT
</td>
<td style="text-align:left;">
200
</td>
<td style="text-align:left;">
73
</td>
<td style="text-align:left;">
104
</td>
<td style="text-align:left;">
38 (36.5%)
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
(91.0 - NA)
</td>
<td style="text-align:left;font-weight: bold;">
0.92
</td>
<td style="text-align:left;">
(0.58 - 1.47)
</td>
<td style="text-align:left;font-weight: bold;">
0.7371
</td>
<td style="text-align:left;font-weight: bold;">
0.7371
</td>
</tr>
<tr>
<td style="text-align:left;">
GeneB cat2
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
CTRL
</td>
<td style="text-align:left;">
200
</td>
<td style="text-align:left;">
95
</td>
<td style="text-align:left;">
108
</td>
<td style="text-align:left;">
50 (46.3%)
</td>
<td style="text-align:left;">
80.4
</td>
<td style="text-align:left;">
(63.6 - NA)
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
TRT
</td>
<td style="text-align:left;">
200
</td>
<td style="text-align:left;">
95
</td>
<td style="text-align:left;">
92
</td>
<td style="text-align:left;">
45 (48.9%)
</td>
<td style="text-align:left;">
87.5
</td>
<td style="text-align:left;">
(82.1 - NA)
</td>
<td style="text-align:left;font-weight: bold;">
0.63
</td>
<td style="text-align:left;">
(0.41 - 0.96)
</td>
<td style="text-align:left;font-weight: bold;">
0.0301 *
</td>
<td style="text-align:left;font-weight: bold;">
0.1204
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## To represent the results with a forest plot</span>

<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wrapper_cox_regression_treatment.html">wrapper_cox_regression_treatment</a></span><span class="op">(</span><span class="va">data</span>, tte_var <span class="op">=</span> <span class="va">tte_var</span>, censor_var <span class="op">=</span> <span class="va">censor_var</span>,
    treatment_var <span class="op">=</span> <span class="va">treatment_var</span>, biomarker_vars <span class="op">=</span> <span class="va">biomarker_vars</span>, adjustment_vars <span class="op">=</span> <span class="va">adjustment_vars</span>,
    print_total <span class="op">=</span> <span class="cn">FALSE</span>, print_adjpvalues <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>


<span class="fu"><a href="../reference/Bclass-class.html">bforest</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/cox_regression-2.png" width="1920" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### Treatment-biomarker interaction effect</span>


<span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span>
<span class="va">tte_var</span> <span class="op">&lt;-</span> <span class="st">"PFS"</span>
<span class="va">censor_var</span> <span class="op">&lt;-</span> <span class="st">"PFS_Event"</span>

<span class="va">treatment_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span>
<span class="va">biomarker_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"GeneA_cat2"</span>, <span class="st">"GeneA"</span><span class="op">)</span>
<span class="va">adjustment_vars</span> <span class="op">&lt;-</span> <span class="st">"IPI"</span>



<span class="fu"><a href="../reference/wrapper_cox_regression_interaction.html">wrapper_cox_regression_interaction</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">tte_var</span>, <span class="va">censor_var</span>, treatment_var <span class="op">=</span> <span class="va">treatment_var</span>,
    biomarker_vars <span class="op">=</span> <span class="va">biomarker_vars</span>, adjustment_vars <span class="op">=</span> <span class="va">adjustment_vars</span><span class="op">)</span></code></pre></div>
<table class="table table table-condensed table-bordered">
<caption style="font-size: initial !important;">
Effect of interaction between biomarker and treatment on PFS. Adjusted, unstratified analysis. Cox regression model includes: biomarker, treatment and IPI.
</caption>
<thead><tr>
<th style="text-align:left;">
Biomarker
</th>
<th style="text-align:left;">
Biomarker Effect
</th>
<th style="text-align:left;">
Treatment Effect
</th>
<th style="text-align:left;">
Total N
</th>
<th style="text-align:left;">
HR
</th>
<th style="text-align:left;">
HR 95% CI
</th>
<th style="text-align:left;">
P-value
</th>
<th style="text-align:left;">
Adj. P-value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
high vs low
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
TRT vs CTRL
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
400
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.92
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(0.50 - 1.70)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.7985
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.8593
</td>
</tr>
<tr>
<td style="text-align:left;">
GeneA
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
TRT vs CTRL
</td>
<td style="text-align:left;">
400
</td>
<td style="text-align:left;font-weight: bold;">
0.97
</td>
<td style="text-align:left;">
(0.72 - 1.32)
</td>
<td style="text-align:left;font-weight: bold;">
0.8593
</td>
<td style="text-align:left;font-weight: bold;">
0.8593
</td>
</tr>
</tbody>
</table>
</div>
<div id="log-rank-test" class="section level1">
<h1 class="hasAnchor">
<a href="#log-rank-test" class="anchor"></a>Log-rank test</h1>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### Biomarker effect</span>

<span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span>
<span class="va">tte_var</span> <span class="op">&lt;-</span> <span class="st">"PFS"</span>
<span class="va">censor_var</span> <span class="op">&lt;-</span> <span class="st">"PFS_Event"</span>

<span class="va">biomarker_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"GeneA_cat2"</span>, <span class="st">"GeneB_cat2"</span><span class="op">)</span>
<span class="va">treatment_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span>


<span class="fu"><a href="../reference/wrapper_log_rank_test_biomarker.html">wrapper_log_rank_test_biomarker</a></span><span class="op">(</span><span class="va">data</span>, tte_var <span class="op">=</span> <span class="va">tte_var</span>, censor_var <span class="op">=</span> <span class="va">censor_var</span>,
    biomarker_vars <span class="op">=</span> <span class="va">biomarker_vars</span>, treatment_var <span class="op">=</span> <span class="va">treatment_var</span><span class="op">)</span></code></pre></div>
<table class="table table table-condensed table-bordered">
<caption style="font-size: initial !important;">
Biomarker effect on PFS. Unstratified log-rank test.
</caption>
<thead><tr>
<th style="text-align:left;">
Treatment Arm
</th>
<th style="text-align:left;">
Biomarker
</th>
<th style="text-align:left;">
Subgroup
</th>
<th style="text-align:left;">
Total N
</th>
<th style="text-align:left;">
Total Events
</th>
<th style="text-align:left;">
N
</th>
<th style="text-align:left;">
Events
</th>
<th style="text-align:left;">
MST
</th>
<th style="text-align:left;">
MST 95% CI
</th>
<th style="text-align:left;">
HR
</th>
<th style="text-align:left;">
HR 95% CI
</th>
<th style="text-align:left;">
P-value
</th>
<th style="text-align:left;">
Adj. P-value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
CTRL
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
low
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
204
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
85
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
104
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
41 (39.4%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
NA
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(76.9 - NA)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.8211
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.8917
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
high
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
204
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
85
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
100
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
44 (44.0%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
83.1
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(82.1 - NA)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
1.05
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(0.69 - 1.61)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
TRT
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
low
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
196
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
83
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
96
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
40 (41.7%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
99.9
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(82.2 - NA)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.8917
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.8917
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
high
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
196
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
83
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
100
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
43 (43.0%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
&gt;100.0
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(81.6 - NA)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.97
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(0.63 - 1.49)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
</tr>
<tr>
<td style="text-align:left;">
CTRL
</td>
<td style="text-align:left;">
GeneB cat2
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
204
</td>
<td style="text-align:left;">
85
</td>
<td style="text-align:left;">
96
</td>
<td style="text-align:left;">
35 (36.5%)
</td>
<td style="text-align:left;">
98.3
</td>
<td style="text-align:left;">
(82.6 - NA)
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;font-weight: bold;">
0.0120 *
</td>
<td style="text-align:left;font-weight: bold;">
0.0478 *
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
204
</td>
<td style="text-align:left;">
85
</td>
<td style="text-align:left;">
108
</td>
<td style="text-align:left;">
50 (46.3%)
</td>
<td style="text-align:left;">
80.4
</td>
<td style="text-align:left;">
(63.6 - NA)
</td>
<td style="text-align:left;font-weight: bold;">
1.73
</td>
<td style="text-align:left;">
(1.12 - 2.68)
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
</tr>
<tr>
<td style="text-align:left;">
TRT
</td>
<td style="text-align:left;">
GeneB cat2
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
196
</td>
<td style="text-align:left;">
83
</td>
<td style="text-align:left;">
104
</td>
<td style="text-align:left;">
38 (36.5%)
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
(91.0 - NA)
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;font-weight: bold;">
0.2437
</td>
<td style="text-align:left;font-weight: bold;">
0.4874
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
196
</td>
<td style="text-align:left;">
83
</td>
<td style="text-align:left;">
92
</td>
<td style="text-align:left;">
45 (48.9%)
</td>
<td style="text-align:left;">
87.5
</td>
<td style="text-align:left;">
(82.1 - NA)
</td>
<td style="text-align:left;font-weight: bold;">
1.29
</td>
<td style="text-align:left;">
(0.84 - 1.99)
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### Treatment effect within biomarker subgroups</span>


<span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span>
<span class="va">tte_var</span> <span class="op">&lt;-</span> <span class="st">"PFS"</span>
<span class="va">censor_var</span> <span class="op">&lt;-</span> <span class="st">"PFS_Event"</span>

<span class="va">treatment_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span>
<span class="va">biomarker_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"GeneA_cat2"</span>, <span class="st">"GeneB_cat2"</span><span class="op">)</span>


<span class="fu"><a href="../reference/wrapper_log_rank_test_treatment.html">wrapper_log_rank_test_treatment</a></span><span class="op">(</span><span class="va">data</span>, tte_var <span class="op">=</span> <span class="va">tte_var</span>, censor_var <span class="op">=</span> <span class="va">censor_var</span>,
    treatment_var <span class="op">=</span> <span class="va">treatment_var</span>, biomarker_vars <span class="op">=</span> <span class="va">biomarker_vars</span><span class="op">)</span></code></pre></div>
<table class="table table table-condensed table-bordered">
<caption style="font-size: initial !important;">
Treatment effect on PFS. Unstratified log-rank test.
</caption>
<thead><tr>
<th style="text-align:left;">
Biomarker
</th>
<th style="text-align:left;">
Biomarker Subgroup
</th>
<th style="text-align:left;">
Treatment Subgroup
</th>
<th style="text-align:left;">
Total N
</th>
<th style="text-align:left;">
Total Events
</th>
<th style="text-align:left;">
N
</th>
<th style="text-align:left;">
Events
</th>
<th style="text-align:left;">
MST
</th>
<th style="text-align:left;">
MST 95% CI
</th>
<th style="text-align:left;">
HR
</th>
<th style="text-align:left;">
HR 95% CI
</th>
<th style="text-align:left;">
P-value
</th>
<th style="text-align:left;">
Adj. P-value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
low
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
CTRL
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
200
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
81
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
104
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
41 (39.4%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
NA
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(76.9 - NA)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.5693
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.7591
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
TRT
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
200
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
81
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
96
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
40 (41.7%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
99.9
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(82.2 - NA)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.88
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(0.57 - 1.37)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
high
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
CTRL
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
200
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
87
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
100
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
44 (44.0%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
83.1
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(82.1 - NA)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.2526
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.5052
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
TRT
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
200
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
87
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
100
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
43 (43.0%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
&gt;100.0
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(81.6 - NA)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.78
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(0.51 - 1.19)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
</tr>
<tr>
<td style="text-align:left;">
GeneB cat2
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
CTRL
</td>
<td style="text-align:left;">
200
</td>
<td style="text-align:left;">
73
</td>
<td style="text-align:left;">
96
</td>
<td style="text-align:left;">
35 (36.5%)
</td>
<td style="text-align:left;">
98.3
</td>
<td style="text-align:left;">
(82.6 - NA)
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;font-weight: bold;">
0.9213
</td>
<td style="text-align:left;font-weight: bold;">
0.9213
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
TRT
</td>
<td style="text-align:left;">
200
</td>
<td style="text-align:left;">
73
</td>
<td style="text-align:left;">
104
</td>
<td style="text-align:left;">
38 (36.5%)
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
(91.0 - NA)
</td>
<td style="text-align:left;font-weight: bold;">
0.98
</td>
<td style="text-align:left;">
(0.62 - 1.55)
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
</tr>
<tr>
<td style="text-align:left;">
GeneB cat2
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
CTRL
</td>
<td style="text-align:left;">
200
</td>
<td style="text-align:left;">
95
</td>
<td style="text-align:left;">
108
</td>
<td style="text-align:left;">
50 (46.3%)
</td>
<td style="text-align:left;">
80.4
</td>
<td style="text-align:left;">
(63.6 - NA)
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;font-weight: bold;">
0.0893 .
</td>
<td style="text-align:left;font-weight: bold;">
0.3574
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
TRT
</td>
<td style="text-align:left;">
200
</td>
<td style="text-align:left;">
95
</td>
<td style="text-align:left;">
92
</td>
<td style="text-align:left;">
45 (48.9%)
</td>
<td style="text-align:left;">
87.5
</td>
<td style="text-align:left;">
(82.1 - NA)
</td>
<td style="text-align:left;font-weight: bold;">
0.70
</td>
<td style="text-align:left;">
(0.47 - 1.06)
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wrapper_log_rank_test_treatment.html">wrapper_log_rank_test_treatment</a></span><span class="op">(</span><span class="va">data</span>, tte_var <span class="op">=</span> <span class="va">tte_var</span>, censor_var <span class="op">=</span> <span class="va">censor_var</span>,
    treatment_var <span class="op">=</span> <span class="va">treatment_var</span>, biomarker_vars <span class="op">=</span> <span class="va">biomarker_vars</span>, print_nevent <span class="op">=</span> <span class="cn">FALSE</span>,
    print_mst <span class="op">=</span> <span class="cn">FALSE</span>, print_total <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>


<span class="fu"><a href="../reference/Bclass-class.html">bkable</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></code></pre></div>
<table class="table table table-condensed table-bordered">
<caption style="font-size: initial !important;">
Treatment effect on PFS. Unstratified log-rank test.
</caption>
<thead><tr>
<th style="text-align:left;">
Biomarker
</th>
<th style="text-align:left;">
Biomarker Subgroup
</th>
<th style="text-align:left;">
Treatment Subgroup
</th>
<th style="text-align:left;">
N
</th>
<th style="text-align:left;">
HR
</th>
<th style="text-align:left;">
HR 95% CI
</th>
<th style="text-align:left;">
P-value
</th>
<th style="text-align:left;">
Adj. P-value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
low
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
CTRL
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
104
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.5693
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.7591
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
TRT
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
96
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.88
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(0.57 - 1.37)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
high
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
CTRL
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
100
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.2526
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.5052
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
TRT
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
100
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.78
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(0.51 - 1.19)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
</tr>
<tr>
<td style="text-align:left;">
GeneB cat2
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
CTRL
</td>
<td style="text-align:left;">
96
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;font-weight: bold;">
0.9213
</td>
<td style="text-align:left;font-weight: bold;">
0.9213
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
TRT
</td>
<td style="text-align:left;">
104
</td>
<td style="text-align:left;font-weight: bold;">
0.98
</td>
<td style="text-align:left;">
(0.62 - 1.55)
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
</tr>
<tr>
<td style="text-align:left;">
GeneB cat2
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
CTRL
</td>
<td style="text-align:left;">
108
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;font-weight: bold;">
0.0893 .
</td>
<td style="text-align:left;font-weight: bold;">
0.3574
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
TRT
</td>
<td style="text-align:left;">
92
</td>
<td style="text-align:left;font-weight: bold;">
0.70
</td>
<td style="text-align:left;">
(0.47 - 1.06)
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/Bclass-class.html">bforest</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/log_rank_test-1.png" width="1920" style="display: block; margin: auto;"></p>
</div>
<div id="km-plot" class="section level1">
<h1 class="hasAnchor">
<a href="#km-plot" class="anchor"></a>KM plot</h1>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span>

<span class="va">tte_var</span> <span class="op">&lt;-</span> <span class="st">"PFS"</span>
<span class="va">censor_var</span> <span class="op">&lt;-</span> <span class="st">"PFS_Event"</span>
<span class="va">covariate_var</span> <span class="op">&lt;-</span> <span class="st">"Treatment_Arm"</span>


<span class="fu"><a href="../reference/wrapper_KM_plot_core.html">wrapper_KM_plot_core</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, tte_var <span class="op">=</span> <span class="va">tte_var</span>, censor_var <span class="op">=</span> <span class="va">censor_var</span>, covariate_var <span class="op">=</span> <span class="va">covariate_var</span><span class="op">)</span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/KM_plot-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span>
<span class="va">tte_var</span> <span class="op">&lt;-</span> <span class="st">"PFS"</span>
<span class="va">censor_var</span> <span class="op">&lt;-</span> <span class="st">"PFS_Event"</span>
<span class="va">covariate_var</span> <span class="op">&lt;-</span> <span class="st">"GeneA_cat2"</span>

<span class="va">strat1_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span>
<span class="va">strat2_var</span> <span class="op">=</span> <span class="st">"Cell_Of_Origin"</span>


<span class="fu"><a href="../reference/wrapper_KM_plot_core.html">wrapper_KM_plot_core_strat</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, tte_var <span class="op">=</span> <span class="va">tte_var</span>, censor_var <span class="op">=</span> <span class="va">censor_var</span>,
    covariate_var <span class="op">=</span> <span class="va">covariate_var</span>, strat1_var <span class="op">=</span> <span class="va">strat1_var</span>, strat2_var <span class="op">=</span> <span class="va">strat2_var</span>,
    linetypes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/KM_plot_strat-1.png" width="960" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span>
<span class="va">tte_var</span> <span class="op">&lt;-</span> <span class="st">"PFS"</span>
<span class="va">censor_var</span> <span class="op">&lt;-</span> <span class="st">"PFS_Event"</span>

<span class="va">biomarker_var</span> <span class="op">&lt;-</span> <span class="st">"GeneA_cat2"</span>
<span class="va">treatment_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span>


<span class="fu"><a href="../reference/wrapper_KM_plot_interaction.html">wrapper_KM_plot_interaction</a></span><span class="op">(</span><span class="va">data</span>, tte_var <span class="op">=</span> <span class="va">tte_var</span>, censor_var <span class="op">=</span> <span class="va">censor_var</span>, biomarker_var <span class="op">=</span> <span class="va">biomarker_var</span>,
    treatment_var <span class="op">=</span> <span class="va">treatment_var</span><span class="op">)</span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/KM_plot_interaction-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/wrapper_KM_plot_interaction.html">wrapper_KM_plot_interaction</a></span><span class="op">(</span><span class="va">data</span>, tte_var <span class="op">=</span> <span class="va">tte_var</span>, censor_var <span class="op">=</span> <span class="va">censor_var</span>, biomarker_var <span class="op">=</span> <span class="va">biomarker_var</span>,
    treatment_var <span class="op">=</span> <span class="va">treatment_var</span>, colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"blue2"</span>, <span class="st">"red"</span>, <span class="st">"red2"</span><span class="op">)</span>, linetypes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,
        <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, line_size <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/KM_plot_interaction-2.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span>
<span class="va">tte_var</span> <span class="op">&lt;-</span> <span class="st">"PFS"</span>
<span class="va">censor_var</span> <span class="op">&lt;-</span> <span class="st">"PFS_Event"</span>

<span class="va">biomarker_var</span> <span class="op">&lt;-</span> <span class="st">"GeneA_cat2"</span>
<span class="va">treatment_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span>


<span class="fu"><a href="../reference/wrapper_KM_plot_biomarker.html">wrapper_KM_plot_biomarker</a></span><span class="op">(</span><span class="va">data</span>, tte_var <span class="op">=</span> <span class="va">tte_var</span>, censor_var <span class="op">=</span> <span class="va">censor_var</span>, biomarker_var <span class="op">=</span> <span class="va">biomarker_var</span>,
    treatment_var <span class="op">=</span> <span class="va">treatment_var</span><span class="op">)</span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/KM_plot_biomarker-1.png" width="960" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span>
<span class="va">tte_var</span> <span class="op">&lt;-</span> <span class="st">"PFS"</span>
<span class="va">censor_var</span> <span class="op">&lt;-</span> <span class="st">"PFS_Event"</span>

<span class="va">biomarker_var</span> <span class="op">&lt;-</span> <span class="st">"GeneA_cat2"</span>
<span class="va">treatment_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span>


<span class="fu"><a href="../reference/wrapper_KM_plot_treatment.html">wrapper_KM_plot_treatment</a></span><span class="op">(</span><span class="va">data</span>, tte_var <span class="op">=</span> <span class="va">tte_var</span>, censor_var <span class="op">=</span> <span class="va">censor_var</span>, biomarker_var <span class="op">=</span> <span class="va">biomarker_var</span>,
    treatment_var <span class="op">=</span> <span class="va">treatment_var</span><span class="op">)</span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/KM_plot_treatment-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div id="logistic-regression" class="section level1">
<h1 class="hasAnchor">
<a href="#logistic-regression" class="anchor"></a>Logistic regression</h1>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### Biomarker effect</span>

<span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span>
<span class="va">response_var</span> <span class="op">&lt;-</span> <span class="st">"ORR"</span>

<span class="va">biomarker_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"GeneA_cat2"</span>, <span class="st">"GeneA"</span><span class="op">)</span>
<span class="va">treatment_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span>
<span class="va">adjustment_vars</span> <span class="op">&lt;-</span> <span class="st">"IPI"</span>


<span class="fu"><a href="../reference/wrapper_logistic_regression_biomarker.html">wrapper_logistic_regression_biomarker</a></span><span class="op">(</span><span class="va">data</span>, response_var <span class="op">=</span> <span class="va">response_var</span>, biomarker_vars <span class="op">=</span> <span class="va">biomarker_vars</span>,
    adjustment_vars <span class="op">=</span> <span class="va">adjustment_vars</span>, treatment_var <span class="op">=</span> <span class="va">treatment_var</span><span class="op">)</span></code></pre></div>
<table class="table table table-condensed table-bordered">
<caption style="font-size: initial !important;">
Biomarker effect on ORR. Adjusted analysis. Logistic regression model includes the biomarker and IPI.
</caption>
<thead><tr>
<th style="text-align:left;">
Treatment Arm
</th>
<th style="text-align:left;">
Biomarker
</th>
<th style="text-align:left;">
Subgroup
</th>
<th style="text-align:left;">
Total N
</th>
<th style="text-align:left;">
N
</th>
<th style="text-align:left;">
NR
</th>
<th style="text-align:left;">
R
</th>
<th style="text-align:left;">
R 95% CI
</th>
<th style="text-align:left;">
OR
</th>
<th style="text-align:left;">
OR 95% CI
</th>
<th style="text-align:left;">
P-value
</th>
<th style="text-align:left;">
Adj. P-value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
CTRL
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
low
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
204
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
104
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
14 (13.5%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
90 (86.5%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(78.45 - 92.44)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
high
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
204
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
100
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
17 (17.0%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
83 (83.0%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(74.18 - 89.77)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.83
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(0.38 - 1.83)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.6467
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.6467
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
TRT
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
low
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
196
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
96
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
18 (18.8%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
78 (81.2%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(72.00 - 88.49)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
high
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
196
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
100
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
15 (15.0%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
85 (85.0%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(76.47 - 91.35)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
1.32
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(0.62 - 2.84)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.4706
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.6275
</td>
</tr>
<tr>
<td style="text-align:left;">
CTRL
</td>
<td style="text-align:left;">
GeneA
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
204
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;font-weight: bold;">
0.86
</td>
<td style="text-align:left;">
(0.60 - 1.25)
</td>
<td style="text-align:left;font-weight: bold;">
0.4412
</td>
<td style="text-align:left;font-weight: bold;">
0.6275
</td>
</tr>
<tr>
<td style="text-align:left;">
TRT
</td>
<td style="text-align:left;">
GeneA
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
196
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;font-weight: bold;">
1.21
</td>
<td style="text-align:left;">
(0.80 - 1.83)
</td>
<td style="text-align:left;font-weight: bold;">
0.3735
</td>
<td style="text-align:left;font-weight: bold;">
0.6275
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### Treatment effect within biomarker subgroups</span>

<span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span>
<span class="va">response_var</span> <span class="op">&lt;-</span> <span class="st">"ORR"</span>

<span class="va">treatment_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span>
<span class="va">biomarker_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"GeneA_cat2"</span>, <span class="st">"GeneB_cat2"</span><span class="op">)</span>
<span class="va">adjustment_vars</span> <span class="op">&lt;-</span> <span class="st">"IPI"</span>


<span class="fu"><a href="../reference/wrapper_logistic_regression_treatment.html">wrapper_logistic_regression_treatment</a></span><span class="op">(</span><span class="va">data</span>, response_var <span class="op">=</span> <span class="va">response_var</span>, treatment_var <span class="op">=</span> <span class="va">treatment_var</span>,
    biomarker_vars <span class="op">=</span> <span class="va">biomarker_vars</span>, adjustment_vars <span class="op">=</span> <span class="va">adjustment_vars</span><span class="op">)</span></code></pre></div>
<table class="table table table-condensed table-bordered">
<caption style="font-size: initial !important;">
Treatment effect on ORR. Adjusted analysis. Logistic regression model includes the treatment and IPI.
</caption>
<thead><tr>
<th style="text-align:left;">
Biomarker
</th>
<th style="text-align:left;">
Biomarker Subgroup
</th>
<th style="text-align:left;">
Treatment Subgroup
</th>
<th style="text-align:left;">
Total N
</th>
<th style="text-align:left;">
N
</th>
<th style="text-align:left;">
NR
</th>
<th style="text-align:left;">
R
</th>
<th style="text-align:left;">
R 95% CI
</th>
<th style="text-align:left;">
OR
</th>
<th style="text-align:left;">
OR 95% CI
</th>
<th style="text-align:left;">
P-value
</th>
<th style="text-align:left;">
Adj. P-value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
low
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
CTRL
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
200
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
104
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
14 (13.5%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
90 (86.5%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(78.45 - 92.44)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
TRT
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
200
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
96
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
18 (18.8%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
78 (81.2%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(72.00 - 88.49)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.67
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(0.31 - 1.44)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.3098
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.6195
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
high
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
CTRL
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
200
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
100
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
17 (17.0%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
83 (83.0%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(74.18 - 89.77)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
TRT
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
200
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
100
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
15 (15.0%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
85 (85.0%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(76.47 - 91.35)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
1.27
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(0.58 - 2.79)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.5434
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.6679
</td>
</tr>
<tr>
<td style="text-align:left;">
GeneB cat2
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
CTRL
</td>
<td style="text-align:left;">
200
</td>
<td style="text-align:left;">
96
</td>
<td style="text-align:left;">
8 (8.3%)
</td>
<td style="text-align:left;">
88 (91.7%)
</td>
<td style="text-align:left;">
(84.24 - 96.33)
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
TRT
</td>
<td style="text-align:left;">
200
</td>
<td style="text-align:left;">
104
</td>
<td style="text-align:left;">
15 (14.4%)
</td>
<td style="text-align:left;">
89 (85.6%)
</td>
<td style="text-align:left;">
(77.33 - 91.70)
</td>
<td style="text-align:left;font-weight: bold;">
0.57
</td>
<td style="text-align:left;">
(0.22 - 1.42)
</td>
<td style="text-align:left;font-weight: bold;">
0.2261
</td>
<td style="text-align:left;font-weight: bold;">
0.6195
</td>
</tr>
<tr>
<td style="text-align:left;">
GeneB cat2
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
CTRL
</td>
<td style="text-align:left;">
200
</td>
<td style="text-align:left;">
108
</td>
<td style="text-align:left;">
23 (21.3%)
</td>
<td style="text-align:left;">
85 (78.7%)
</td>
<td style="text-align:left;">
(69.78 - 86.00)
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
TRT
</td>
<td style="text-align:left;">
200
</td>
<td style="text-align:left;">
92
</td>
<td style="text-align:left;">
18 (19.6%)
</td>
<td style="text-align:left;">
74 (80.4%)
</td>
<td style="text-align:left;">
(70.85 - 87.97)
</td>
<td style="text-align:left;font-weight: bold;">
1.17
</td>
<td style="text-align:left;">
(0.58 - 2.36)
</td>
<td style="text-align:left;font-weight: bold;">
0.6679
</td>
<td style="text-align:left;font-weight: bold;">
0.6679
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### Treatment-biomarker interaction effect</span>


<span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span>
<span class="va">response_var</span> <span class="op">&lt;-</span> <span class="st">"ORR"</span>

<span class="va">treatment_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span>
<span class="va">biomarker_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"GeneA_cat2"</span>, <span class="st">"GeneA"</span><span class="op">)</span>
<span class="va">adjustment_vars</span> <span class="op">&lt;-</span> <span class="st">"IPI"</span>



<span class="fu"><a href="../reference/wrapper_logistic_regression_interaction.html">wrapper_logistic_regression_interaction</a></span><span class="op">(</span><span class="va">data</span>, response_var <span class="op">=</span> <span class="va">response_var</span>, treatment_var <span class="op">=</span> <span class="va">treatment_var</span>,
    biomarker_vars <span class="op">=</span> <span class="va">biomarker_vars</span>, adjustment_vars <span class="op">=</span> <span class="va">adjustment_vars</span><span class="op">)</span></code></pre></div>
<table class="table table table-condensed table-bordered">
<caption style="font-size: initial !important;">
Effect of interaction between biomarker and treatment on ORR.Adjusted analysis. Logistic regression model includes the biomarker, treatment and IPI.
</caption>
<thead><tr>
<th style="text-align:left;">
Biomarker
</th>
<th style="text-align:left;">
Biomarker Effect
</th>
<th style="text-align:left;">
Treatment Effect
</th>
<th style="text-align:left;">
Total n
</th>
<th style="text-align:left;">
OR
</th>
<th style="text-align:left;">
OR 95% CI
</th>
<th style="text-align:left;">
P-value
</th>
<th style="text-align:left;">
Adj. P-value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
high vs low
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
TRT vs CTRL
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
400
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
1.83
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(0.62 - 5.39)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.2766
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.2766
</td>
</tr>
<tr>
<td style="text-align:left;">
GeneA
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
TRT vs CTRL
</td>
<td style="text-align:left;">
400
</td>
<td style="text-align:left;font-weight: bold;">
1.42
</td>
<td style="text-align:left;">
(0.82 - 2.48)
</td>
<td style="text-align:left;font-weight: bold;">
0.2113
</td>
<td style="text-align:left;font-weight: bold;">
0.2766
</td>
</tr>
</tbody>
</table>
</div>
<div id="pearsons-test" class="section level1">
<h1 class="hasAnchor">
<a href="#pearsons-test" class="anchor"></a>Pearsonâ€™s test</h1>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### Biomarker effect</span>

<span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span>
<span class="va">response_var</span> <span class="op">&lt;-</span> <span class="st">"ORR"</span>

<span class="va">biomarker_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"GeneA_cat2"</span><span class="op">)</span>
<span class="va">treatment_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span>

<span class="fu"><a href="../reference/wrapper_pearsons_test_biomarker.html">wrapper_pearsons_test_biomarker</a></span><span class="op">(</span><span class="va">data</span>, response_var <span class="op">=</span> <span class="va">response_var</span>, biomarker_vars <span class="op">=</span> <span class="va">biomarker_vars</span>,
    treatment_var <span class="op">=</span> <span class="va">treatment_var</span><span class="op">)</span></code></pre></div>
<table class="table table table-condensed table-bordered">
<caption style="font-size: initial !important;">
Biomarker effect on ORR. Unstratified Pearsonâ€™s Chi-squared test.
</caption>
<thead><tr>
<th style="text-align:left;">
Treatment Arm
</th>
<th style="text-align:left;">
Biomarker
</th>
<th style="text-align:left;">
Subgroup
</th>
<th style="text-align:left;">
Total N
</th>
<th style="text-align:left;">
N
</th>
<th style="text-align:left;">
NR
</th>
<th style="text-align:left;">
R
</th>
<th style="text-align:left;">
R 95% CI
</th>
<th style="text-align:left;">
Difference
</th>
<th style="text-align:left;">
Difference 95% CI
</th>
<th style="text-align:left;">
P-value
</th>
<th style="text-align:left;">
Adj. P-value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
CTRL
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
low
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
204
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
104
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
14 (13.5%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
90 (86.5%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(78.45 - 92.44)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
-3.54
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(-14.38 - 7.30)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.6110
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.6110
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
high
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
204
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
100
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
17 (17.0%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
83 (83.0%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(74.18 - 89.77)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
TRT
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
low
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
196
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
96
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
18 (18.8%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
78 (81.2%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(72.00 - 88.49)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
3.75
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(-7.76 - 15.26)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.6097
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.6110
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
high
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
196
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
100
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
15 (15.0%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
85 (85.0%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(76.47 - 91.35)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### Treatment effect within biomarker subgroups</span>


<span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span>
<span class="va">response_var</span> <span class="op">&lt;-</span> <span class="st">"ORR"</span>

<span class="va">biomarker_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"GeneA_cat2"</span><span class="op">)</span>
<span class="va">treatment_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span>

<span class="fu"><a href="../reference/wrapper_pearsons_test_treatment.html">wrapper_pearsons_test_treatment</a></span><span class="op">(</span><span class="va">data</span>, response_var <span class="op">=</span> <span class="va">response_var</span>, biomarker_vars <span class="op">=</span> <span class="va">biomarker_vars</span>,
    treatment_var <span class="op">=</span> <span class="va">treatment_var</span><span class="op">)</span></code></pre></div>
<table class="table table table-condensed table-bordered">
<caption style="font-size: initial !important;">
Treatment effect on ORR. Unstratified Pearsonâ€™s Chi-squared test.
</caption>
<thead><tr>
<th style="text-align:left;">
Biomarker
</th>
<th style="text-align:left;">
Biomarker Subgroup
</th>
<th style="text-align:left;">
Treatment Subgroup
</th>
<th style="text-align:left;">
Total N
</th>
<th style="text-align:left;">
N
</th>
<th style="text-align:left;">
NR
</th>
<th style="text-align:left;">
R
</th>
<th style="text-align:left;">
R 95% CI
</th>
<th style="text-align:left;">
Difference
</th>
<th style="text-align:left;">
Difference 95% CI
</th>
<th style="text-align:left;">
P-value
</th>
<th style="text-align:left;">
Adj. P-value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
low
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
CTRL
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
200
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
104
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
14 (13.5%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
90 (86.5%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(78.45 - 92.44)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
-5.29
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(-16.49 - 5.91)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.4087
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.8174
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
TRT
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
200
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
96
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
18 (18.8%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
78 (81.2%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(72.00 - 88.49)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
high
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
CTRL
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
200
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
100
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
17 (17.0%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
83 (83.0%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(74.18 - 89.77)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
2.00
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(-9.16 - 13.16)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.8471
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.8471
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
TRT
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
200
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
100
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
15 (15.0%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
85 (85.0%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(76.47 - 91.35)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
</tr>
</tbody>
</table>
</div>
<div id="cochran-mantel-haenszel-chi-squared-test" class="section level1">
<h1 class="hasAnchor">
<a href="#cochran-mantel-haenszel-chi-squared-test" class="anchor"></a>Cochran-Mantel-Haenszel Chi-Squared Test</h1>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### Biomarker effect</span>

<span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span>
<span class="va">response_var</span> <span class="op">&lt;-</span> <span class="st">"ORR"</span>

<span class="va">biomarker_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"GeneA_cat2"</span><span class="op">)</span>
<span class="va">treatment_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span>
<span class="va">strata_vars</span> <span class="op">&lt;-</span> <span class="st">"IPI"</span>


<span class="fu"><a href="../reference/wrapper_pearsons_test_biomarker.html">wrapper_pearsons_test_biomarker</a></span><span class="op">(</span><span class="va">data</span>, response_var <span class="op">=</span> <span class="va">response_var</span>, biomarker_vars <span class="op">=</span> <span class="va">biomarker_vars</span>,
    treatment_var <span class="op">=</span> <span class="va">treatment_var</span>, strata_vars <span class="op">=</span> <span class="va">strata_vars</span><span class="op">)</span></code></pre></div>
<table class="table table table-condensed table-bordered">
<caption style="font-size: initial !important;">
Biomarker effect on ORR. Stratified Cochran-Mantel-Haenszel Chi-squared test. Stratification factors: IPI.
</caption>
<thead><tr>
<th style="text-align:left;">
Treatment Arm
</th>
<th style="text-align:left;">
Biomarker
</th>
<th style="text-align:left;">
Subgroup
</th>
<th style="text-align:left;">
Total N
</th>
<th style="text-align:left;">
N
</th>
<th style="text-align:left;">
NR
</th>
<th style="text-align:left;">
R
</th>
<th style="text-align:left;">
R 95% CI
</th>
<th style="text-align:left;">
Difference
</th>
<th style="text-align:left;">
Difference 95% CI
</th>
<th style="text-align:left;">
P-value
</th>
<th style="text-align:left;">
Adj. P-value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
CTRL
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
low
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
204
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
104
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
14 (13.5%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
90 (86.5%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(78.45 - 92.44)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
-3.54
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(-14.38 - 7.30)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.7990
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.7990
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
high
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
204
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
100
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
17 (17.0%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
83 (83.0%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(74.18 - 89.77)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
TRT
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
low
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
196
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
96
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
18 (18.8%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
78 (81.2%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(72.00 - 88.49)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
3.75
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(-7.76 - 15.26)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.6010
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.7990
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
high
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
196
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
100
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
15 (15.0%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
85 (85.0%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(76.47 - 91.35)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### Treatment effect within biomarker subgroups</span>


<span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span>
<span class="va">response_var</span> <span class="op">&lt;-</span> <span class="st">"ORR"</span>

<span class="va">biomarker_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"GeneA_cat2"</span><span class="op">)</span>
<span class="va">treatment_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span>
<span class="va">strata_vars</span> <span class="op">&lt;-</span> <span class="st">"IPI"</span>


<span class="fu"><a href="../reference/wrapper_pearsons_test_treatment.html">wrapper_pearsons_test_treatment</a></span><span class="op">(</span><span class="va">data</span>, response_var <span class="op">=</span> <span class="va">response_var</span>, biomarker_vars <span class="op">=</span> <span class="va">biomarker_vars</span>,
    treatment_var <span class="op">=</span> <span class="va">treatment_var</span>, strata_vars <span class="op">=</span> <span class="va">strata_vars</span><span class="op">)</span></code></pre></div>
<table class="table table table-condensed table-bordered">
<caption style="font-size: initial !important;">
Treatment effect on ORR. Stratified Cochran-Mantel-Haenszel Chi-squared test. Stratification factors: IPI.
</caption>
<thead><tr>
<th style="text-align:left;">
Biomarker
</th>
<th style="text-align:left;">
Biomarker Subgroup
</th>
<th style="text-align:left;">
Treatment Subgroup
</th>
<th style="text-align:left;">
Total N
</th>
<th style="text-align:left;">
N
</th>
<th style="text-align:left;">
NR
</th>
<th style="text-align:left;">
R
</th>
<th style="text-align:left;">
R 95% CI
</th>
<th style="text-align:left;">
Difference
</th>
<th style="text-align:left;">
Difference 95% CI
</th>
<th style="text-align:left;">
P-value
</th>
<th style="text-align:left;">
Adj. P-value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
low
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
CTRL
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
200
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
104
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
14 (13.5%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
90 (86.5%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(78.45 - 92.44)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
-5.29
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(-16.49 - 5.91)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.4133
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.6850
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
TRT
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
200
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
96
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
18 (18.8%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
78 (81.2%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(72.00 - 88.49)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
high
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
CTRL
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
200
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
100
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
17 (17.0%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
83 (83.0%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(74.18 - 89.77)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
2.00
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(-9.16 - 13.16)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.6850
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.6850
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
TRT
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
200
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
100
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
15 (15.0%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
85 (85.0%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
(76.47 - 91.35)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
</tr>
</tbody>
</table>
</div>
<div id="barplot-response" class="section level1">
<h1 class="hasAnchor">
<a href="#barplot-response" class="anchor"></a>Barplot response</h1>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### Biomarker effect</span>

<span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span>
<span class="va">response_var</span> <span class="op">&lt;-</span> <span class="st">"ORR"</span>

<span class="va">biomarker_var</span> <span class="op">&lt;-</span> <span class="st">"GeneA_cat2"</span>
<span class="va">treatment_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span>


<span class="fu"><a href="../reference/wrapper_bar_plot_biomarker.html">wrapper_bar_plot_biomarker</a></span><span class="op">(</span><span class="va">data</span>, response_var <span class="op">=</span> <span class="va">response_var</span>, biomarker_var <span class="op">=</span> <span class="va">biomarker_var</span>,
    treatment_var <span class="op">=</span> <span class="va">treatment_var</span>, variable_names <span class="op">=</span> <span class="va">variable_names</span>, less_legends <span class="op">=</span> <span class="cn">TRUE</span>,
    ylab <span class="op">=</span> <span class="st">"ORR Proportion (%)"</span>, strat1_label_both <span class="op">=</span> <span class="cn">FALSE</span>, legend_colors_title <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/unnamed-chunk-3-1.png" width="1152" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### Treatment effect</span>

<span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span>
<span class="va">response_var</span> <span class="op">&lt;-</span> <span class="st">"ORR"</span>

<span class="va">biomarker_var</span> <span class="op">&lt;-</span> <span class="st">"GeneA_cat2"</span>
<span class="va">treatment_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span>


<span class="fu"><a href="../reference/wrapper_bar_plot_treatment.html">wrapper_bar_plot_treatment</a></span><span class="op">(</span><span class="va">data</span>, response_var <span class="op">=</span> <span class="va">response_var</span>, biomarker_var <span class="op">=</span> <span class="va">biomarker_var</span>,
    treatment_var <span class="op">=</span> <span class="va">treatment_var</span>, variable_names <span class="op">=</span> <span class="va">variable_names</span>, less_legends <span class="op">=</span> <span class="cn">TRUE</span>,
    ylab <span class="op">=</span> <span class="st">"R Proportion (%)"</span>, strat1_label_both <span class="op">=</span> <span class="cn">FALSE</span>, legend_colors_title <span class="op">=</span> <span class="cn">FALSE</span>,
    skip_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"NR"</span><span class="op">)</span>, legend_position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/unnamed-chunk-4-1.png" width="768" style="display: block; margin: auto;"></p>
</div>
<div id="barplot" class="section level1">
<h1 class="hasAnchor">
<a href="#barplot" class="anchor"></a>Barplot</h1>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span>

<span class="va">x_var</span> <span class="op">=</span> <span class="st">"GeneA_cat2"</span>
<span class="va">y_var</span> <span class="op">=</span> <span class="st">"Response"</span>


<span class="fu"><a href="../reference/wrapper_bar_plot_core.html">wrapper_bar_plot_core</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, x_var <span class="op">=</span> <span class="va">x_var</span>, y_var <span class="op">=</span> <span class="va">y_var</span><span class="op">)</span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/barplot-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span>

<span class="va">x_var</span> <span class="op">=</span> <span class="st">"GeneA_cat2"</span>
<span class="va">y_var</span> <span class="op">=</span> <span class="st">"Response"</span>
<span class="va">skip_levels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"NE"</span>, <span class="st">"PD"</span>, <span class="st">"SD"</span><span class="op">)</span>
<span class="va">show_subtotal_proportions</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span>

<span class="fu"><a href="../reference/wrapper_bar_plot_core.html">wrapper_bar_plot_core</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, x_var <span class="op">=</span> <span class="va">x_var</span>, y_var <span class="op">=</span> <span class="va">y_var</span>, show_subtotal_proportions <span class="op">=</span> <span class="va">show_subtotal_proportions</span>,
    skip_levels <span class="op">=</span> <span class="va">skip_levels</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/barplot-2.png" width="576" style="display: block; margin: auto;"></p>
<div id="stratified" class="section level2">
<h2 class="hasAnchor">
<a href="#stratified" class="anchor"></a>Stratified</h2>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span>

<span class="va">x_var</span> <span class="op">=</span> <span class="st">"GeneA_cat2"</span>
<span class="va">y_var</span> <span class="op">=</span> <span class="st">"Response"</span>
<span class="va">facet_var</span> <span class="op">&lt;-</span> <span class="st">"Treatment_Arm"</span>


<span class="fu"><a href="../reference/wrapper_bar_plot_core.html">wrapper_bar_plot_core</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, x_var <span class="op">=</span> <span class="va">x_var</span>, y_var <span class="op">=</span> <span class="va">y_var</span>, facet_var <span class="op">=</span> <span class="va">facet_var</span><span class="op">)</span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/unnamed-chunk-5-1.png" width="960" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span>

<span class="va">x_var</span> <span class="op">=</span> <span class="st">"GeneA_cat2"</span>
<span class="va">y_var</span> <span class="op">=</span> <span class="st">"Response"</span>

<span class="va">strat1_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span>
<span class="va">strat2_var</span> <span class="op">=</span> <span class="st">"Cell_Of_Origin"</span>


<span class="fu"><a href="../reference/wrapper_bar_plot_core.html">wrapper_bar_plot_core_strat</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, x_var <span class="op">=</span> <span class="va">x_var</span>, y_var <span class="op">=</span> <span class="va">y_var</span>, strat1_var <span class="op">=</span> <span class="va">strat1_var</span>,
    strat2_var <span class="op">=</span> <span class="va">strat2_var</span><span class="op">)</span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/unnamed-chunk-6-1.png" width="960" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/wrapper_bar_plot_core.html">wrapper_bar_plot_core_strat</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, x_var <span class="op">=</span> <span class="va">x_var</span>, y_var <span class="op">=</span> <span class="va">y_var</span>, strat1_var <span class="op">=</span> <span class="va">strat1_var</span>,
    strat2_var <span class="op">=</span> <span class="va">strat2_var</span>, less_legends <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/unnamed-chunk-6-2.png" width="960" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="complex-barplot" class="section level1">
<h1 class="hasAnchor">
<a href="#complex-barplot" class="anchor"></a>Complex barplot</h1>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span>

<span class="va">x_var</span> <span class="op">&lt;-</span> <span class="st">"Cell_Of_Origin"</span>
<span class="va">y_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"GeneA_cat2"</span>, <span class="st">"GeneB_cat2"</span>, <span class="st">"GeneC_cat2"</span><span class="op">)</span>


<span class="fu"><a href="../reference/wrapper_bar_plot_yvars_core_strat.html">wrapper_bar_plot_yvars_core_strat</a></span><span class="op">(</span><span class="va">data</span>, x_var <span class="op">=</span> <span class="va">x_var</span>, y_vars <span class="op">=</span> <span class="va">y_vars</span>, values_to <span class="op">=</span> <span class="st">"Gene expression"</span><span class="op">)</span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/Complex_barplot-1.png" width="960" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span>

<span class="va">x_var</span> <span class="op">&lt;-</span> <span class="st">"Cell_Of_Origin"</span>
<span class="va">y_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"GeneA_cat2"</span>, <span class="st">"GeneB_cat2"</span>, <span class="st">"GeneC_cat2"</span><span class="op">)</span>

<span class="va">skip_levels</span> <span class="op">&lt;-</span> <span class="st">"low"</span>
<span class="va">method</span> <span class="op">&lt;-</span> <span class="st">"dodge"</span>


<span class="fu"><a href="../reference/wrapper_bar_plot_yvars_core_strat.html">wrapper_bar_plot_yvars_core_strat</a></span><span class="op">(</span><span class="va">data</span>, x_var <span class="op">=</span> <span class="va">x_var</span>, y_vars <span class="op">=</span> <span class="va">y_vars</span>, skip_levels <span class="op">=</span> <span class="va">skip_levels</span>,
    method <span class="op">=</span> <span class="va">method</span>, values_to <span class="op">=</span> <span class="st">"Gene expression"</span>, names_to <span class="op">=</span> <span class="st">"Gene"</span><span class="op">)</span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/Complex_barplot-2.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div id="fishers-test" class="section level1">
<h1 class="hasAnchor">
<a href="#fishers-test" class="anchor"></a>Fisherâ€™s test</h1>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span>

<span class="va">col_var</span> <span class="op">&lt;-</span> <span class="st">"Cell_Of_Origin"</span>
<span class="va">row_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"GeneA_cat2"</span>, <span class="st">"GeneB_cat2"</span>, <span class="st">"GeneC_cat2"</span><span class="op">)</span>


<span class="fu"><a href="../reference/wrapper_fishers_test.html">wrapper_fishers_test</a></span><span class="op">(</span><span class="va">data</span>, col_var <span class="op">=</span> <span class="va">col_var</span>, row_vars <span class="op">=</span> <span class="va">row_vars</span><span class="op">)</span></code></pre></div>
<table class="table table table-condensed table-bordered">
<caption style="font-size: initial !important;">
Fisherâ€™s exact test.
</caption>
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="2">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Cell Of Origin
</div>
</th>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="2">
</th>
</tr>
<tr>
<th style="text-align:left;">
Covariate
</th>
<th style="text-align:left;">
Subgroup
</th>
<th style="text-align:left;">
GCB
</th>
<th style="text-align:left;">
UNCLASSIFIED
</th>
<th style="text-align:left;">
ABC
</th>
<th style="text-align:left;">
P-value
</th>
<th style="text-align:left;">
Adj. P-value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
low
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
116 (59.5%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
23 (11.8%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
56 (28.7%)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.0810 .
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.0810 .
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
high
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
102 (52.0%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
39 (19.9%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
55 (28.1%)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
</tr>
<tr>
<td style="text-align:left;">
GeneB cat2
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
124 (62.9%)
</td>
<td style="text-align:left;">
27 (13.7%)
</td>
<td style="text-align:left;">
46 (23.4%)
</td>
<td style="text-align:left;font-weight: bold;">
0.0156 *
</td>
<td style="text-align:left;font-weight: bold;">
0.0468 *
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
94 (48.5%)
</td>
<td style="text-align:left;">
35 (18.0%)
</td>
<td style="text-align:left;">
65 (33.5%)
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
GeneC cat2
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
low
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
109 (56.5%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
23 (11.9%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
61 (31.6%)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.0782 .
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.0810 .
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
high
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
109 (55.1%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
39 (19.7%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
50 (25.3%)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/wrapper_fishers_test.html">wrapper_fishers_test</a></span><span class="op">(</span><span class="va">data</span>, col_var <span class="op">=</span> <span class="va">col_var</span>, row_vars <span class="op">=</span> <span class="va">row_vars</span>, margin <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<table class="table table table-condensed table-bordered">
<caption style="font-size: initial !important;">
Fisherâ€™s exact test.
</caption>
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="2">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Cell Of Origin
</div>
</th>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="2">
</th>
</tr>
<tr>
<th style="text-align:left;">
Covariate
</th>
<th style="text-align:left;">
Subgroup
</th>
<th style="text-align:left;">
GCB
</th>
<th style="text-align:left;">
UNCLASSIFIED
</th>
<th style="text-align:left;">
ABC
</th>
<th style="text-align:left;">
P-value
</th>
<th style="text-align:left;">
Adj. P-value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
low
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
116 (53.2%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
23 (37.1%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
56 (50.5%)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.0810 .
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.0810 .
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
high
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
102 (46.8%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
39 (62.9%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
55 (49.5%)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
</tr>
<tr>
<td style="text-align:left;">
GeneB cat2
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
124 (56.9%)
</td>
<td style="text-align:left;">
27 (43.5%)
</td>
<td style="text-align:left;">
46 (41.4%)
</td>
<td style="text-align:left;font-weight: bold;">
0.0156 *
</td>
<td style="text-align:left;font-weight: bold;">
0.0468 *
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
94 (43.1%)
</td>
<td style="text-align:left;">
35 (56.5%)
</td>
<td style="text-align:left;">
65 (58.6%)
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
GeneC cat2
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
low
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
109 (50.0%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
23 (37.1%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
61 (55.0%)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.0782 .
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.0810 .
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
high
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
109 (50.0%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
39 (62.9%)
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
50 (45.0%)
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
</tr>
</tbody>
</table>
</div>
<div id="box-plot" class="section level1">
<h1 class="hasAnchor">
<a href="#box-plot" class="anchor"></a>Box plot</h1>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span>

<span class="va">x_var</span> <span class="op">&lt;-</span> <span class="st">"Cell_Of_Origin"</span>
<span class="va">y_var</span> <span class="op">&lt;-</span> <span class="st">"GeneA"</span>


<span class="fu"><a href="../reference/wrapper_box_plot_core.html">wrapper_box_plot_core</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, x_var <span class="op">=</span> <span class="va">x_var</span>, y_var <span class="op">=</span> <span class="va">y_var</span><span class="op">)</span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/Box_plot-1.png" width="672" style="display: block; margin: auto;"></p>
<div id="stratified-1" class="section level2">
<h2 class="hasAnchor">
<a href="#stratified-1" class="anchor"></a>Stratified</h2>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span>

<span class="va">x_var</span> <span class="op">&lt;-</span> <span class="st">"Cell_Of_Origin"</span>
<span class="va">y_var</span> <span class="op">&lt;-</span> <span class="st">"GeneA"</span>
<span class="va">facet_var</span> <span class="op">&lt;-</span> <span class="st">"Treatment_Arm"</span>
<span class="va">dodge_var</span> <span class="op">=</span> <span class="cn">NULL</span>


<span class="fu"><a href="../reference/wrapper_box_plot_core.html">wrapper_box_plot_core</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, x_var <span class="op">=</span> <span class="va">x_var</span>, y_var <span class="op">=</span> <span class="va">y_var</span>, facet_var <span class="op">=</span> <span class="va">facet_var</span>,
    dodge_var <span class="op">=</span> <span class="va">dodge_var</span><span class="op">)</span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/Box_plot_strat-1.png" width="768" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span>

<span class="va">x_var</span> <span class="op">&lt;-</span> <span class="st">"Treatment_Arm"</span>
<span class="va">y_var</span> <span class="op">&lt;-</span> <span class="st">"GeneA"</span>
<span class="va">facet_var</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
<span class="va">dodge_var</span> <span class="op">=</span> <span class="st">"Cell_Of_Origin"</span>


<span class="fu"><a href="../reference/wrapper_box_plot_core.html">wrapper_box_plot_core</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, x_var <span class="op">=</span> <span class="va">x_var</span>, y_var <span class="op">=</span> <span class="va">y_var</span>, facet_var <span class="op">=</span> <span class="va">facet_var</span>,
    dodge_var <span class="op">=</span> <span class="va">dodge_var</span><span class="op">)</span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/Box_plot_strat-2.png" width="768" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span>

<span class="va">x_var</span> <span class="op">&lt;-</span> <span class="st">"Cell_Of_Origin"</span>
<span class="va">y_var</span> <span class="op">&lt;-</span> <span class="st">"GeneA"</span>


<span class="va">strat1_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span>


<span class="fu"><a href="../reference/wrapper_box_plot_core.html">wrapper_box_plot_core_strat</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, x_var <span class="op">=</span> <span class="va">x_var</span>, y_var <span class="op">=</span> <span class="va">y_var</span>, strat1_var <span class="op">=</span> <span class="va">strat1_var</span><span class="op">)</span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/Box_plot_strat-3.png" width="768" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="complex-boxplot" class="section level1">
<h1 class="hasAnchor">
<a href="#complex-boxplot" class="anchor"></a>Complex boxplot</h1>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span>
<span class="va">y_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"GeneA"</span>, <span class="st">"GeneB"</span>, <span class="st">"GeneC"</span><span class="op">)</span>


<span class="fu"><a href="../reference/wrapper_box_plot_yvars_core_strat.html">wrapper_box_plot_yvars_core_strat</a></span><span class="op">(</span><span class="va">data</span>, y_vars <span class="op">=</span> <span class="va">y_vars</span><span class="op">)</span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/complex_boxplot-1.png" width="960" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span>
<span class="va">y_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"GeneA"</span>, <span class="st">"GeneB"</span>, <span class="st">"GeneC"</span><span class="op">)</span>

<span class="va">x_var</span> <span class="op">=</span> <span class="st">"Cell_Of_Origin"</span>
<span class="va">facet_var</span> <span class="op">=</span> <span class="cn">NULL</span>
<span class="va">dodge_var</span> <span class="op">=</span> <span class="cn">NULL</span>


<span class="fu"><a href="../reference/wrapper_box_plot_yvars_core_strat.html">wrapper_box_plot_yvars_core_strat</a></span><span class="op">(</span><span class="va">data</span>, y_vars <span class="op">=</span> <span class="va">y_vars</span>, x_var <span class="op">=</span> <span class="va">x_var</span>, facet_var <span class="op">=</span> <span class="va">facet_var</span>,
    dodge_var <span class="op">=</span> <span class="va">dodge_var</span><span class="op">)</span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/complex_boxplot-2.png" width="960" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span>
<span class="va">y_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"GeneA"</span>, <span class="st">"GeneB"</span>, <span class="st">"GeneC"</span><span class="op">)</span>

<span class="va">x_var</span> <span class="op">=</span> <span class="cn">NULL</span>
<span class="va">facet_var</span> <span class="op">=</span> <span class="cn">NULL</span>
<span class="va">dodge_var</span> <span class="op">=</span> <span class="st">"Cell_Of_Origin"</span>


<span class="fu"><a href="../reference/wrapper_box_plot_yvars_core_strat.html">wrapper_box_plot_yvars_core_strat</a></span><span class="op">(</span><span class="va">data</span>, y_vars <span class="op">=</span> <span class="va">y_vars</span>, x_var <span class="op">=</span> <span class="va">x_var</span>, facet_var <span class="op">=</span> <span class="va">facet_var</span>,
    dodge_var <span class="op">=</span> <span class="va">dodge_var</span><span class="op">)</span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/complex_boxplot-3.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div id="kruskalwallis-h-test" class="section level1">
<h1 class="hasAnchor">
<a href="#kruskalwallis-h-test" class="anchor"></a>Kruskalâ€“Wallis H test</h1>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span>

<span class="va">cat_vars</span> <span class="op">&lt;-</span> <span class="st">"Cell_Of_Origin"</span>
<span class="va">num_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"GeneA"</span>, <span class="st">"GeneB"</span><span class="op">)</span>


<span class="fu"><a href="../reference/wrapper_kruskal_test.html">wrapper_kruskal_test</a></span><span class="op">(</span><span class="va">data</span>, num_vars <span class="op">=</span> <span class="va">num_vars</span>, cat_vars <span class="op">=</span> <span class="va">cat_vars</span><span class="op">)</span></code></pre></div>
<table class="table table table-condensed table-bordered">
<caption style="font-size: initial !important;">
Kruskal-Wallis H test.
</caption>
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="2">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Cell Of Origin
</div>
</th>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="2">
</th>
</tr>
<tr>
<th style="text-align:left;">
Covariate
</th>
<th style="text-align:left;">
Statistic
</th>
<th style="text-align:left;">
GCB
</th>
<th style="text-align:left;">
UNCLASSIFIED
</th>
<th style="text-align:left;">
ABC
</th>
<th style="text-align:left;">
P-value
</th>
<th style="text-align:left;">
Adj. P-value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
GeneA
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
N
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
218
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
62
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
111
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.0265 *
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.0440 *
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
Median
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
7.95
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
8.53
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
7.98
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
</tr>
<tr>
<td style="text-align:left;">
GeneB
</td>
<td style="text-align:left;">
N
</td>
<td style="text-align:left;">
218
</td>
<td style="text-align:left;">
62
</td>
<td style="text-align:left;">
111
</td>
<td style="text-align:left;font-weight: bold;">
0.0440 *
</td>
<td style="text-align:left;font-weight: bold;">
0.0440 *
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Median
</td>
<td style="text-align:left;">
7.92
</td>
<td style="text-align:left;">
8.10
</td>
<td style="text-align:left;">
8.12
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/wrapper_kruskal_test.html">wrapper_kruskal_test</a></span><span class="op">(</span><span class="va">data</span>, num_vars <span class="op">=</span> <span class="va">num_vars</span>, cat_vars <span class="op">=</span> <span class="va">cat_vars</span>, print_pvalues <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<table class="table table table-condensed table-bordered">
<caption style="font-size: initial !important;">
Kruskal-Wallis H test.
</caption>
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="2">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Cell Of Origin
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Covariate
</th>
<th style="text-align:left;">
Statistic
</th>
<th style="text-align:left;">
GCB
</th>
<th style="text-align:left;">
UNCLASSIFIED
</th>
<th style="text-align:left;">
ABC
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
GeneA
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
N
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
218
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
62
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
111
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
Median
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
7.95
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
8.53
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
7.98
</td>
</tr>
<tr>
<td style="text-align:left;">
GeneB
</td>
<td style="text-align:left;">
N
</td>
<td style="text-align:left;">
218
</td>
<td style="text-align:left;">
62
</td>
<td style="text-align:left;">
111
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Median
</td>
<td style="text-align:left;">
7.92
</td>
<td style="text-align:left;">
8.10
</td>
<td style="text-align:left;">
8.12
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span>

<span class="va">cat_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Cell_Of_Origin"</span>, <span class="st">"IPI"</span>, <span class="st">"Treatment_Arm"</span><span class="op">)</span>
<span class="va">num_vars</span> <span class="op">&lt;-</span> <span class="st">"GeneA"</span>


<span class="fu"><a href="../reference/wrapper_kruskal_test.html">wrapper_kruskal_test</a></span><span class="op">(</span><span class="va">data</span>, num_vars <span class="op">=</span> <span class="va">num_vars</span>, cat_vars <span class="op">=</span> <span class="va">cat_vars</span><span class="op">)</span></code></pre></div>
<table class="table table table-condensed table-bordered">
<caption style="font-size: initial !important;">
Kruskal-Wallis H test.
</caption>
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="2">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
GeneA
</div>
</th>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="3">
</th>
</tr>
<tr>
<th style="text-align:left;">
Covariate
</th>
<th style="text-align:left;">
Subgroup
</th>
<th style="text-align:left;">
N
</th>
<th style="text-align:left;">
Median
</th>
<th style="text-align:left;">
Difference
</th>
<th style="text-align:left;">
P-value
</th>
<th style="text-align:left;">
Adj. P-value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
Cell Of Origin
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
GCB
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
218
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
7.95
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
NA
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.0265 *
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.0794 .
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
UNCLASSIFIED
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
62
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
8.53
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
ABC
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
111
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
7.98
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
</tr>
<tr>
<td style="text-align:left;">
IPI
</td>
<td style="text-align:left;">
Low
</td>
<td style="text-align:left;">
79
</td>
<td style="text-align:left;">
7.87
</td>
<td style="text-align:left;font-weight: bold;">
NA
</td>
<td style="text-align:left;font-weight: bold;">
0.0867 .
</td>
<td style="text-align:left;font-weight: bold;">
0.1301
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Low-Intermediate
</td>
<td style="text-align:left;">
147
</td>
<td style="text-align:left;">
7.93
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
High-Intermediate
</td>
<td style="text-align:left;">
108
</td>
<td style="text-align:left;">
8.29
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
High
</td>
<td style="text-align:left;">
66
</td>
<td style="text-align:left;">
7.90
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
Treatment Arm
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
CTRL
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
204
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
7.98
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.06
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.9043
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
0.9043
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
TRT
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
196
</td>
<td style="text-align:left;background-color: #F2F4F4 !important;">
8.03
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #F2F4F4 !important;">
</td>
</tr>
</tbody>
</table>
</div>
<div id="point-plot" class="section level1">
<h1 class="hasAnchor">
<a href="#point-plot" class="anchor"></a>Point plot</h1>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span>

<span class="va">x_var</span> <span class="op">&lt;-</span> <span class="st">"GeneA"</span>
<span class="va">y_var</span> <span class="op">&lt;-</span> <span class="st">"GeneB"</span>


<span class="fu"><a href="../reference/wrapper_point_plot_core.html">wrapper_point_plot_core</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, x_var <span class="op">=</span> <span class="va">x_var</span>, y_var <span class="op">=</span> <span class="va">y_var</span><span class="op">)</span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/Point_plot-1.png" width="576" style="display: block; margin: auto;"></p>
<div id="stratified-2" class="section level2">
<h2 class="hasAnchor">
<a href="#stratified-2" class="anchor"></a>Stratified</h2>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span>

<span class="va">x_var</span> <span class="op">&lt;-</span> <span class="st">"GeneA"</span>
<span class="va">y_var</span> <span class="op">&lt;-</span> <span class="st">"GeneB"</span>
<span class="va">facet_var</span> <span class="op">&lt;-</span> <span class="st">"Treatment_Arm"</span>
<span class="va">color_point_var</span> <span class="op">&lt;-</span> <span class="st">"Cell_Of_Origin"</span>


<span class="fu"><a href="../reference/wrapper_point_plot_core.html">wrapper_point_plot_core</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, x_var <span class="op">=</span> <span class="va">x_var</span>, y_var <span class="op">=</span> <span class="va">y_var</span>, facet_var <span class="op">=</span> <span class="va">facet_var</span>,
    color_point_var <span class="op">=</span> <span class="va">color_point_var</span><span class="op">)</span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/Point_plot_strat-1.png" width="1152" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span>

<span class="va">x_var</span> <span class="op">&lt;-</span> <span class="st">"GeneD"</span>
<span class="va">y_var</span> <span class="op">&lt;-</span> <span class="st">"GeneB"</span>
<span class="va">facet_var</span> <span class="op">&lt;-</span> <span class="st">"Treatment_Arm"</span>
<span class="va">strat1_var</span> <span class="op">&lt;-</span> <span class="st">"Cell_Of_Origin"</span>


<span class="fu"><a href="../reference/wrapper_point_plot_core.html">wrapper_point_plot_core_strat</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, x_var <span class="op">=</span> <span class="va">x_var</span>, y_var <span class="op">=</span> <span class="va">y_var</span>, facet_var <span class="op">=</span> <span class="va">facet_var</span>,
    strat1_var <span class="op">=</span> <span class="va">strat1_var</span><span class="op">)</span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/Point_plot_strat-2.png" width="1152" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="characteristics-of-itt-and-bep" class="section level1">
<h1 class="hasAnchor">
<a href="#characteristics-of-itt-and-bep" class="anchor"></a>Characteristics of ITT and BEP</h1>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span>

<span class="va">strat_var</span> <span class="op">&lt;-</span> <span class="st">"Treatment_Arm"</span>
<span class="va">covariate_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Age"</span>, <span class="st">"IPI"</span><span class="op">)</span>


<span class="fu"><a href="../reference/wrapper_characteristics_core.html">wrapper_characteristics_core</a></span><span class="op">(</span><span class="va">data</span>, strat_var <span class="op">=</span> <span class="va">strat_var</span>, covariate_vars <span class="op">=</span> <span class="va">covariate_vars</span><span class="op">)</span></code></pre></div>
<table class="table table table-condensed table-bordered">
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Treatment Arm
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Covariate
</th>
<th style="text-align:left;">
CTRL
</th>
<th style="text-align:left;">
TRT
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;background-color: #d7ecff !important;">
Age
</td>
<td style="text-align:left;font-weight: bold;background-color: #d7ecff !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #d7ecff !important;">
</td>
</tr>
<tr>
<td style="text-align:left;color: #666666 !important;background-color: #f0f8ff !important;">
N
</td>
<td style="text-align:left;color: #666666 !important;background-color: #f0f8ff !important;">
252
</td>
<td style="text-align:left;color: #666666 !important;background-color: #f0f8ff !important;">
248
</td>
</tr>
<tr>
<td style="text-align:left;color: #666666 !important;background-color: #f0f8ff !important;">
NAs
</td>
<td style="text-align:left;color: #666666 !important;background-color: #f0f8ff !important;">
0
</td>
<td style="text-align:left;color: #666666 !important;background-color: #f0f8ff !important;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Median
</td>
<td style="text-align:left;">
63.00
</td>
<td style="text-align:left;">
63.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Mean
</td>
<td style="text-align:left;">
60.73
</td>
<td style="text-align:left;">
61.05
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;background-color: #d7ecff !important;">
IPI
</td>
<td style="text-align:left;font-weight: bold;background-color: #d7ecff !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #d7ecff !important;">
</td>
</tr>
<tr>
<td style="text-align:left;color: #666666 !important;background-color: #f0f8ff !important;">
N
</td>
<td style="text-align:left;color: #666666 !important;background-color: #f0f8ff !important;">
252
</td>
<td style="text-align:left;color: #666666 !important;background-color: #f0f8ff !important;">
248
</td>
</tr>
<tr>
<td style="text-align:left;color: #666666 !important;background-color: #f0f8ff !important;">
NAs
</td>
<td style="text-align:left;color: #666666 !important;background-color: #f0f8ff !important;">
0
</td>
<td style="text-align:left;color: #666666 !important;background-color: #f0f8ff !important;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Low
</td>
<td style="text-align:left;">
52 (20.63%)
</td>
<td style="text-align:left;">
48 (19.35%)
</td>
</tr>
<tr>
<td style="text-align:left;">
Low-Intermediate
</td>
<td style="text-align:left;">
95 (37.70%)
</td>
<td style="text-align:left;">
88 (35.48%)
</td>
</tr>
<tr>
<td style="text-align:left;">
High-Intermediate
</td>
<td style="text-align:left;">
71 (28.17%)
</td>
<td style="text-align:left;">
64 (25.81%)
</td>
</tr>
<tr>
<td style="text-align:left;">
High
</td>
<td style="text-align:left;">
34 (13.49%)
</td>
<td style="text-align:left;">
48 (19.35%)
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bep_vars</span> <span class="op">&lt;-</span> <span class="st">"BEP_RNAseq"</span>
<span class="va">covariate_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Age"</span>, <span class="st">"IPI"</span><span class="op">)</span>

<span class="va">treatment_var</span> <span class="op">&lt;-</span> <span class="st">"Treatment_Arm"</span>
<span class="va">itt_name</span> <span class="op">=</span> <span class="st">"ITT"</span>


<span class="fu"><a href="../reference/wrapper_characteristics_bep.html">wrapper_characteristics_bep</a></span><span class="op">(</span><span class="va">data</span>, covariate_vars <span class="op">=</span> <span class="va">covariate_vars</span>, bep_vars <span class="op">=</span> <span class="va">bep_vars</span>,
    treatment_var <span class="op">=</span> <span class="va">treatment_var</span>, itt_name <span class="op">=</span> <span class="va">itt_name</span><span class="op">)</span></code></pre></div>
<table class="table table table-condensed table-bordered">
<thead><tr>
<th style="text-align:left;">
Covariate
</th>
<th style="text-align:left;">
ITT
</th>
<th style="text-align:left;">
ITT : CTRL
</th>
<th style="text-align:left;">
ITT : TRT
</th>
<th style="text-align:left;">
BEP RNAseq
</th>
<th style="text-align:left;">
BEP RNAseq : CTRL
</th>
<th style="text-align:left;">
BEP RNAseq : TRT
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;background-color: #d7ecff !important;">
Age
</td>
<td style="text-align:left;font-weight: bold;background-color: #d7ecff !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #d7ecff !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #d7ecff !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #d7ecff !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #d7ecff !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #d7ecff !important;">
</td>
</tr>
<tr>
<td style="text-align:left;color: #666666 !important;background-color: #f0f8ff !important;">
N
</td>
<td style="text-align:left;color: #666666 !important;background-color: #f0f8ff !important;">
500
</td>
<td style="text-align:left;color: #666666 !important;background-color: #f0f8ff !important;">
252
</td>
<td style="text-align:left;color: #666666 !important;background-color: #f0f8ff !important;">
248
</td>
<td style="text-align:left;color: #666666 !important;background-color: #f0f8ff !important;">
400
</td>
<td style="text-align:left;color: #666666 !important;background-color: #f0f8ff !important;">
204
</td>
<td style="text-align:left;color: #666666 !important;background-color: #f0f8ff !important;">
196
</td>
</tr>
<tr>
<td style="text-align:left;color: #666666 !important;background-color: #f0f8ff !important;">
NAs
</td>
<td style="text-align:left;color: #666666 !important;background-color: #f0f8ff !important;">
0
</td>
<td style="text-align:left;color: #666666 !important;background-color: #f0f8ff !important;">
0
</td>
<td style="text-align:left;color: #666666 !important;background-color: #f0f8ff !important;">
0
</td>
<td style="text-align:left;color: #666666 !important;background-color: #f0f8ff !important;">
0
</td>
<td style="text-align:left;color: #666666 !important;background-color: #f0f8ff !important;">
0
</td>
<td style="text-align:left;color: #666666 !important;background-color: #f0f8ff !important;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Median
</td>
<td style="text-align:left;">
63.00
</td>
<td style="text-align:left;">
63.00
</td>
<td style="text-align:left;">
63.00
</td>
<td style="text-align:left;">
63.00
</td>
<td style="text-align:left;">
63.00
</td>
<td style="text-align:left;">
63.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Mean
</td>
<td style="text-align:left;">
60.89
</td>
<td style="text-align:left;">
60.73
</td>
<td style="text-align:left;">
61.05
</td>
<td style="text-align:left;">
61.71
</td>
<td style="text-align:left;">
61.50
</td>
<td style="text-align:left;">
61.93
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;background-color: #d7ecff !important;">
IPI
</td>
<td style="text-align:left;font-weight: bold;background-color: #d7ecff !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #d7ecff !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #d7ecff !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #d7ecff !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #d7ecff !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: #d7ecff !important;">
</td>
</tr>
<tr>
<td style="text-align:left;color: #666666 !important;background-color: #f0f8ff !important;">
N
</td>
<td style="text-align:left;color: #666666 !important;background-color: #f0f8ff !important;">
500
</td>
<td style="text-align:left;color: #666666 !important;background-color: #f0f8ff !important;">
252
</td>
<td style="text-align:left;color: #666666 !important;background-color: #f0f8ff !important;">
248
</td>
<td style="text-align:left;color: #666666 !important;background-color: #f0f8ff !important;">
400
</td>
<td style="text-align:left;color: #666666 !important;background-color: #f0f8ff !important;">
204
</td>
<td style="text-align:left;color: #666666 !important;background-color: #f0f8ff !important;">
196
</td>
</tr>
<tr>
<td style="text-align:left;color: #666666 !important;background-color: #f0f8ff !important;">
NAs
</td>
<td style="text-align:left;color: #666666 !important;background-color: #f0f8ff !important;">
0
</td>
<td style="text-align:left;color: #666666 !important;background-color: #f0f8ff !important;">
0
</td>
<td style="text-align:left;color: #666666 !important;background-color: #f0f8ff !important;">
0
</td>
<td style="text-align:left;color: #666666 !important;background-color: #f0f8ff !important;">
0
</td>
<td style="text-align:left;color: #666666 !important;background-color: #f0f8ff !important;">
0
</td>
<td style="text-align:left;color: #666666 !important;background-color: #f0f8ff !important;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Low
</td>
<td style="text-align:left;">
100 (20.00%)
</td>
<td style="text-align:left;">
52 (20.63%)
</td>
<td style="text-align:left;">
48 (19.35%)
</td>
<td style="text-align:left;">
79 (19.75%)
</td>
<td style="text-align:left;">
44 (21.57%)
</td>
<td style="text-align:left;">
35 (17.86%)
</td>
</tr>
<tr>
<td style="text-align:left;">
Low-Intermediate
</td>
<td style="text-align:left;">
183 (36.60%)
</td>
<td style="text-align:left;">
95 (37.70%)
</td>
<td style="text-align:left;">
88 (35.48%)
</td>
<td style="text-align:left;">
147 (36.75%)
</td>
<td style="text-align:left;">
73 (35.78%)
</td>
<td style="text-align:left;">
74 (37.76%)
</td>
</tr>
<tr>
<td style="text-align:left;">
High-Intermediate
</td>
<td style="text-align:left;">
135 (27.00%)
</td>
<td style="text-align:left;">
71 (28.17%)
</td>
<td style="text-align:left;">
64 (25.81%)
</td>
<td style="text-align:left;">
108 (27.00%)
</td>
<td style="text-align:left;">
59 (28.92%)
</td>
<td style="text-align:left;">
49 (25.00%)
</td>
</tr>
<tr>
<td style="text-align:left;">
High
</td>
<td style="text-align:left;">
82 (16.40%)
</td>
<td style="text-align:left;">
34 (13.49%)
</td>
<td style="text-align:left;">
48 (19.35%)
</td>
<td style="text-align:left;">
66 (16.50%)
</td>
<td style="text-align:left;">
28 (13.73%)
</td>
<td style="text-align:left;">
38 (19.39%)
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## R version 4.1.3 (2022-03-10)
## Platform: x86_64-apple-darwin17.0 (64-bit)
## Running under: macOS Big Sur/Monterey 10.16
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] BiomarkerWrappers_0.0.0.35 kableExtra_1.3.4          
## [3] rmarkdown_2.11             knitr_1.36                
## 
## loaded via a namespace (and not attached):
##   [1] ggtext_0.1.1          matrixStats_0.61.0    fs_1.5.0             
##   [4] doParallel_1.0.16     webshot_0.5.2         RColorBrewer_1.1-2   
##   [7] httr_1.4.2            rprojroot_2.0.2       tools_4.1.3          
##  [10] backports_1.3.0       bslib_0.3.1           utf8_1.2.2           
##  [13] R6_2.5.1              vipor_0.4.5           DBI_1.1.1            
##  [16] BiocGenerics_0.40.0   colorspace_2.0-2      GetoptLong_1.0.5     
##  [19] gridExtra_2.3         tidyselect_1.1.1      compiler_4.1.3       
##  [22] textshaping_0.3.6     rvest_1.0.2           formatR_1.11         
##  [25] xml2_1.3.2            desc_1.4.0            labeling_0.4.2       
##  [28] sass_0.4.0            scales_1.1.1          checkmate_2.0.0      
##  [31] survMisc_0.5.5        pkgdown_1.6.1         systemfonts_1.0.2    
##  [34] stringr_1.4.0         digest_0.6.29         svglite_2.0.0        
##  [37] pkgconfig_2.0.3       htmltools_0.5.2       fastmap_1.1.0        
##  [40] limma_3.50.0          highr_0.9             rlang_0.4.12         
##  [43] GlobalOptions_0.1.2   rstudioapi_0.13       shape_1.4.6          
##  [46] jquerylib_0.1.4       generics_0.1.1        farver_2.1.0         
##  [49] zoo_1.8-9             jsonlite_1.7.2        car_3.0-12           
##  [52] dplyr_1.0.7           magrittr_2.0.1        Matrix_1.4-0         
##  [55] ggbeeswarm_0.6.0      Rcpp_1.0.7            munsell_0.5.0        
##  [58] S4Vectors_0.32.1      fansi_0.5.0           abind_1.4-5          
##  [61] lifecycle_1.0.1       stringi_1.7.5         yaml_2.2.1           
##  [64] carData_3.0-4         plyr_1.8.6            grid_4.1.3           
##  [67] parallel_4.1.3        crayon_1.4.2          survminer_0.4.9      
##  [70] lattice_0.20-45       cowplot_1.1.1         splines_4.1.3        
##  [73] gridtext_0.1.4        circlize_0.4.13       ComplexHeatmap_2.10.0
##  [76] pillar_1.6.4          ggpubr_0.4.0          rjson_0.2.20         
##  [79] markdown_1.1          ggsignif_0.6.3        codetools_0.2-18     
##  [82] stats4_4.1.3          glue_1.5.1            evaluate_0.14        
##  [85] data.table_1.14.2     png_0.1-7             vctrs_0.3.8          
##  [88] foreach_1.5.1         gtable_0.3.0          purrr_0.3.4          
##  [91] tidyr_1.1.4.9000      km.ci_0.5-2           clue_0.3-60          
##  [94] assertthat_0.2.1      cachem_1.0.6          ggplot2_3.3.5        
##  [97] xfun_0.28             xtable_1.8-4          broom_0.7.10         
## [100] rstatix_0.7.0         ragg_1.1.3            survival_3.2-13      
## [103] viridisLite_0.4.0     tibble_3.1.5          forestplot_2.0.1     
## [106] iterators_1.0.13      beeswarm_0.4.0        KMsurv_0.1-5         
## [109] memoise_2.0.1         IRanges_2.28.0        cluster_2.1.2        
## [112] ellipsis_0.3.2</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Malgorzata Nowicka.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
