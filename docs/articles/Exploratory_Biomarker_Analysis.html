<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="BiomarkerWrappers">
<title>Exploratory biomarker analysis • BiomarkerWrappers</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Exploratory biomarker analysis">
<meta property="og:description" content="BiomarkerWrappers">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">BiomarkerWrappers</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.60</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Differential_Gene_Expression.html">Differential gene expression</a>
    <a class="dropdown-item" href="../articles/Exploratory_Biomarker_Analysis.html">Exploratory biomarker analysis</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="Exploratory_Biomarker_Analysis_files/kePrint-0.0.1/kePrint.js"></script><link href="Exploratory_Biomarker_Analysis_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Exploratory biomarker analysis</h1>
                        <h4 data-toc-skip class="author">Malgorzata Nowicka</h4>
            
            <h4 data-toc-skip class="date">2024-09-30</h4>
      
      
      <div class="d-none name"><code>Exploratory_Biomarker_Analysis.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Packages to compile rmarkdown</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/rmarkdown" class="external-link">rmarkdown</a></span><span class="op">)</span></span>
<span><span class="co">### Packages for nice tables</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/" class="external-link">kableExtra</a></span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">font_size</span> <span class="op">&lt;-</span> <span class="fl">9</span></span>
<span><span class="va">cache</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span></span>
<span><span class="co">### Set global option for font_size for bkable in this document </span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>bkable_font_size <span class="op">=</span> <span class="va">font_size</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>bkable_full_width <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html" class="external-link">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>cache <span class="op">=</span> <span class="va">cache</span>, cache.comments <span class="op">=</span> <span class="cn">FALSE</span>, echo <span class="op">=</span> <span class="cn">TRUE</span>, warning <span class="op">=</span> <span class="cn">FALSE</span>, message <span class="op">=</span> <span class="cn">FALSE</span>, error <span class="op">=</span> <span class="cn">FALSE</span>, fig.width <span class="op">=</span> <span class="fl">6</span>, fig.height <span class="op">=</span> <span class="fl">5</span>, fig.align <span class="op">=</span> <span class="st">"center"</span>, tidy<span class="op">=</span><span class="cn">TRUE</span>, tidy.opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>width.cutoff <span class="op">=</span> <span class="fl">80</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">### Necessary for knit_child</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_knit.html" class="external-link">opts_knit</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>output.dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/theme_cowplot.html" class="external-link">theme_cowplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">BiomarkerWrappers</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="load-data">Load data<a class="anchor" aria-label="anchor" href="#load-data"></a>
</h2>
<p><code>bdata</code> object contains random survival and biomarker data. It is not expected to observe any biologically meaningful associations. The goal for this data sets is solely to demonstrate the functionality of this package.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">bdata</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co">### Dichotomize gene expression into low and high</span></span>
<span></span>
<span><span class="va">genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BCL2"</span>, <span class="st">"GeneA"</span>, <span class="st">"GeneB"</span>, <span class="st">"GeneC"</span>, <span class="st">"GeneD"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_cat2</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">mutate_all</a></span><span class="op">(</span><span class="va">bdata</span><span class="op">[</span>, <span class="va">genes</span><span class="op">]</span>, <span class="va">wrapper_cut_2groups</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data_cat2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">genes</span>, <span class="st">"_cat2"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">### Stratify gene expression into quartiles</span></span>
<span></span>
<span><span class="va">data_cat4</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">mutate_all</a></span><span class="op">(</span><span class="va">bdata</span><span class="op">[</span>, <span class="va">genes</span><span class="op">]</span>, <span class="va">wrapper_cut_quartiles</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data_cat4</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">genes</span>, <span class="st">"_cat4"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">bdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">bdata</span>, <span class="va">data_cat2</span>, <span class="va">data_cat4</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="define-variable-names">Define variable names<a class="anchor" aria-label="anchor" href="#define-variable-names"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">variable_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/format_variable_names.html">format_variable_names</a></span><span class="op">(</span><span class="va">bdata</span><span class="op">)</span></span>
<span></span>
<span><span class="va">variable_names</span></span></code></pre></div>
<pre><code><span><span class="co">##          Patient_ID                 Age                 Sex                 IPI </span></span>
<span><span class="co">##        "Patient ID"               "Age"               "Sex"               "IPI" </span></span>
<span><span class="co">##   Geographic_Region       Treatment_Arm                 PFS           PFS_Event </span></span>
<span><span class="co">## "Geographic Region"     "Treatment Arm"               "PFS"         "PFS Event" </span></span>
<span><span class="co">##            Response      Cell_Of_Origin         BCL2_by_IHC        BCL2_by_FISH </span></span>
<span><span class="co">##          "Response"    "Cell Of Origin"       "BCL2 by IHC"      "BCL2 by FISH" </span></span>
<span><span class="co">##                BCL2               GeneA               GeneB               GeneC </span></span>
<span><span class="co">##              "BCL2"             "GeneA"             "GeneB"             "GeneC" </span></span>
<span><span class="co">##               GeneD          BEP_RNAseq                 ORR           BCL2_cat2 </span></span>
<span><span class="co">##             "GeneD"        "BEP RNAseq"               "ORR"         "BCL2 cat2" </span></span>
<span><span class="co">##          GeneA_cat2          GeneB_cat2          GeneC_cat2          GeneD_cat2 </span></span>
<span><span class="co">##        "GeneA cat2"        "GeneB cat2"        "GeneC cat2"        "GeneD cat2" </span></span>
<span><span class="co">##           BCL2_cat4          GeneA_cat4          GeneB_cat4          GeneC_cat4 </span></span>
<span><span class="co">##         "BCL2 cat4"        "GeneA cat4"        "GeneB cat4"        "GeneC cat4" </span></span>
<span><span class="co">##          GeneD_cat4 </span></span>
<span><span class="co">##        "GeneD cat4"</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Adjust variable names</span></span>
<span></span>
<span><span class="va">variable_names</span><span class="op">[[</span><span class="st">"GeneA_cat2"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Gene A stratified by median"</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="tile-plot">Tile plot<a class="anchor" aria-label="anchor" href="#tile-plot"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Plot generated using geom_tile</span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_tile_plot1_core.html">wrapper_tile_plot1_core</a></span><span class="op">(</span><span class="va">bdata</span>, y_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BCL2_by_IHC"</span>, <span class="st">"BCL2_by_FISH"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/unnamed-chunk-2-1.png" width="960" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n\n ------ \n\n"</span><span class="op">)</span></span></code></pre></div>
<hr>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Plot generated using geom_col. It has substantially smaller size when</span></span>
<span><span class="co">### sample size is large.</span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_tile_plot1_core.html">wrapper_tile_plot2_core</a></span><span class="op">(</span><span class="va">bdata</span>, y_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BCL2_by_IHC"</span>, <span class="st">"BCL2_by_FISH"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/unnamed-chunk-2-2.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="cox-regression">Cox regression<a class="anchor" aria-label="anchor" href="#cox-regression"></a>
</h2>
<p>In <code><a href="../reference/wrapper_cox_regression_core_simple.html">wrapper_cox_regression_core_simple()</a></code>, covariate_vars Vector with names of covariates that are included in the formula of the simple additive model: <code>~ covariate_vars[1] + covariate_vars[2] + covariate_vars[3] + ...</code>.</p>
<p>This function is the core function and should not be used for the analysis, it is a function called by the other functions such as <code>wrapper_cox_regression_biomarker</code> and <code>wrapper_cox_regression_treatment</code>.</p>
<p>In <code>wrapper_cox_regression_biomarker</code> and <code>wrapper_cox_regression_treatment</code>, <code>biomarker_vars</code> is a vector with biomarker names. For each biomarker a separate Cox regression model is fitted. The results are combined in a single table.</p>
<p>In <code>wrapper_cox_regression_biomarker</code> and <code>wrapper_cox_regression_treatment</code>, <code>adjustment_vars</code> are added additionally to <code>biomarker_vars</code> and <code>treatment_var</code> to the model, for example, <code>~ biomarker_vars[i] + treatment_var + adjustment_vars[1] + adjustment_vars[2] + ...</code></p>
<p><code>adjustment_vars</code> would be the official stratification factors from the study plus any other variables you want to use for adjustment, for example, any other known prognostic factors.</p>
<p><code>strata_vars</code>, would be the same as <code>adjustment_vars</code>. The difference is that when you define <code>strata_vars</code> they are used in Cox regression as “true stratification factors” with the formula <code>~ biomarker_vars[i] + treatment_var + strata(strata_vars[1] + strata_vars[2] + ...)</code></p>
<p>See <a href="https://stats.stackexchange.com/questions/256148/stratification-in-cox-model" class="external-link uri">https://stats.stackexchange.com/questions/256148/stratification-in-cox-model</a></p>
<p><code>strat1_var</code>, <code>strat2_var</code> are used to split the data (I should call them <code>split1_var</code>, <code>split2_var</code>). Then the analysis is done within the subgroups of each of the variables. For example, if <code>strat2_var = "PDL1"</code>, the Cox regression is run separately within the PDL1 low and PDL1 high.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Biomarker effect</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span><span class="va">tte_var</span> <span class="op">&lt;-</span> <span class="st">"PFS"</span></span>
<span><span class="va">censor_var</span> <span class="op">&lt;-</span> <span class="st">"PFS_Event"</span></span>
<span></span>
<span><span class="va">biomarker_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GeneA_cat2"</span>, <span class="st">"GeneA"</span><span class="op">)</span></span>
<span><span class="va">adjustment_vars</span> <span class="op">&lt;-</span> <span class="st">"IPI"</span></span>
<span></span>
<span><span class="va">treatment_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_cox_regression_biomarker.html">wrapper_cox_regression_biomarker</a></span><span class="op">(</span><span class="va">data</span>, tte_var <span class="op">=</span> <span class="va">tte_var</span>, censor_var <span class="op">=</span> <span class="va">censor_var</span>,</span>
<span>    biomarker_vars <span class="op">=</span> <span class="va">biomarker_vars</span>, adjustment_vars <span class="op">=</span> <span class="va">adjustment_vars</span>, treatment_var <span class="op">=</span> <span class="va">treatment_var</span><span class="op">)</span></span></code></pre></div>
<table class="table table table-condensed table-bordered" style="font-size: 9px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Biomarker effect on PFS. Adjusted, unstratified analysis. Cox regression model includes the biomarker and IPI.
</caption>
<thead><tr>
<th style="text-align:left;">
Treatment Arm
</th>
<th style="text-align:left;">
Biomarker
</th>
<th style="text-align:left;">
Subgroup
</th>
<th style="text-align:left;">
Total N
</th>
<th style="text-align:left;">
Total Events
</th>
<th style="text-align:left;">
N
</th>
<th style="text-align:left;">
Events
</th>
<th style="text-align:left;">
MST
</th>
<th style="text-align:left;">
MST 95% CI
</th>
<th style="text-align:left;">
HR
</th>
<th style="text-align:left;">
HR 95% CI
</th>
<th style="text-align:left;">
P-value
</th>
<th style="text-align:left;">
Adj. P-value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
CTRL
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
low
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
204
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
85
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
104
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
41 (39.4%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
NA
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(76.9 - NA)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
high
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
204
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
85
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
100
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
44 (44.0%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
83.1
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(82.1 - NA)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
1.00
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(0.65 - 1.55)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.9828
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.9828
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
TRT
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
low
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
196
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
83
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
96
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
40 (41.7%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
99.9
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(82.2 - NA)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
high
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
196
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
83
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
100
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
43 (43.0%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
100.3
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(81.6 - NA)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.91
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(0.59 - 1.41)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.6827
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.9828
</td>
</tr>
<tr>
<td style="text-align:left;">
CTRL
</td>
<td style="text-align:left;">
GeneA
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
204
</td>
<td style="text-align:left;">
85
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;font-weight: bold;">
1.06
</td>
<td style="text-align:left;">
(0.86 - 1.31)
</td>
<td style="text-align:left;font-weight: bold;">
0.5723
</td>
<td style="text-align:left;font-weight: bold;">
0.9828
</td>
</tr>
<tr>
<td style="text-align:left;">
TRT
</td>
<td style="text-align:left;">
GeneA
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
196
</td>
<td style="text-align:left;">
83
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;font-weight: bold;">
1.03
</td>
<td style="text-align:left;">
(0.82 - 1.29)
</td>
<td style="text-align:left;font-weight: bold;">
0.8129
</td>
<td style="text-align:left;font-weight: bold;">
0.9828
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## To represent the results with a forest plot</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wrapper_cox_regression_biomarker.html">wrapper_cox_regression_biomarker</a></span><span class="op">(</span><span class="va">data</span>, tte_var <span class="op">=</span> <span class="va">tte_var</span>, censor_var <span class="op">=</span> <span class="va">censor_var</span>,</span>
<span>    biomarker_vars <span class="op">=</span> <span class="va">biomarker_vars</span>, adjustment_vars <span class="op">=</span> <span class="va">adjustment_vars</span>, treatment_var <span class="op">=</span> <span class="va">treatment_var</span>,</span>
<span>    print_total <span class="op">=</span> <span class="cn">FALSE</span>, print_adjpvalues <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/Bclass-class.html">bforest</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/cox_regression-1.png" width="1920" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Treatment effect within biomarker subgroups</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span><span class="va">tte_var</span> <span class="op">&lt;-</span> <span class="st">"PFS"</span></span>
<span><span class="va">censor_var</span> <span class="op">&lt;-</span> <span class="st">"PFS_Event"</span></span>
<span></span>
<span><span class="va">treatment_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span></span>
<span><span class="va">biomarker_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GeneA_cat2"</span>, <span class="st">"GeneB_cat2"</span><span class="op">)</span></span>
<span><span class="va">adjustment_vars</span> <span class="op">&lt;-</span> <span class="st">"IPI"</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_cox_regression_treatment.html">wrapper_cox_regression_treatment</a></span><span class="op">(</span><span class="va">data</span>, tte_var <span class="op">=</span> <span class="va">tte_var</span>, censor_var <span class="op">=</span> <span class="va">censor_var</span>,</span>
<span>    treatment_var <span class="op">=</span> <span class="va">treatment_var</span>, biomarker_vars <span class="op">=</span> <span class="va">biomarker_vars</span>, adjustment_vars <span class="op">=</span> <span class="va">adjustment_vars</span><span class="op">)</span></span></code></pre></div>
<table class="table table table-condensed table-bordered" style="font-size: 9px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Treatment effect on PFS. Adjusted, unstratified analysis. Cox regression model includes the treatment and IPI.
</caption>
<thead><tr>
<th style="text-align:left;">
Biomarker
</th>
<th style="text-align:left;">
Biomarker Subgroup
</th>
<th style="text-align:left;">
Treatment Subgroup
</th>
<th style="text-align:left;">
Total N
</th>
<th style="text-align:left;">
Total Events
</th>
<th style="text-align:left;">
N
</th>
<th style="text-align:left;">
Events
</th>
<th style="text-align:left;">
MST
</th>
<th style="text-align:left;">
MST 95% CI
</th>
<th style="text-align:left;">
HR
</th>
<th style="text-align:left;">
HR 95% CI
</th>
<th style="text-align:left;">
P-value
</th>
<th style="text-align:left;">
Adj. P-value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
low
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
CTRL
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
200
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
81
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
104
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
41 (39.4%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
NA
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(76.9 - NA)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
TRT
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
200
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
81
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
96
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
40 (41.7%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
99.9
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(82.2 - NA)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.83
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(0.53 - 1.30)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.4156
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.5541
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
high
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
CTRL
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
200
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
87
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
100
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
44 (44.0%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
83.1
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(82.1 - NA)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
TRT
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
200
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
87
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
100
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
43 (43.0%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
100.3
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(81.6 - NA)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.75
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(0.49 - 1.15)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.1917
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.3835
</td>
</tr>
<tr>
<td style="text-align:left;">
GeneB cat2
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
CTRL
</td>
<td style="text-align:left;">
200
</td>
<td style="text-align:left;">
73
</td>
<td style="text-align:left;">
96
</td>
<td style="text-align:left;">
35 (36.5%)
</td>
<td style="text-align:left;">
98.3
</td>
<td style="text-align:left;">
(82.6 - NA)
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
TRT
</td>
<td style="text-align:left;">
200
</td>
<td style="text-align:left;">
73
</td>
<td style="text-align:left;">
104
</td>
<td style="text-align:left;">
38 (36.5%)
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
(91.0 - NA)
</td>
<td style="text-align:left;font-weight: bold;">
0.92
</td>
<td style="text-align:left;">
(0.58 - 1.47)
</td>
<td style="text-align:left;font-weight: bold;">
0.7371
</td>
<td style="text-align:left;font-weight: bold;">
0.7371
</td>
</tr>
<tr>
<td style="text-align:left;">
GeneB cat2
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
CTRL
</td>
<td style="text-align:left;">
200
</td>
<td style="text-align:left;">
95
</td>
<td style="text-align:left;">
108
</td>
<td style="text-align:left;">
50 (46.3%)
</td>
<td style="text-align:left;">
80.4
</td>
<td style="text-align:left;">
(63.6 - NA)
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
TRT
</td>
<td style="text-align:left;">
200
</td>
<td style="text-align:left;">
95
</td>
<td style="text-align:left;">
92
</td>
<td style="text-align:left;">
45 (48.9%)
</td>
<td style="text-align:left;">
87.5
</td>
<td style="text-align:left;">
(82.1 - NA)
</td>
<td style="text-align:left;font-weight: bold;">
0.63
</td>
<td style="text-align:left;">
(0.41 - 0.96)
</td>
<td style="text-align:left;font-weight: bold;">
0.0301 *
</td>
<td style="text-align:left;font-weight: bold;">
0.1204
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## To represent the results with a forest plot</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wrapper_cox_regression_treatment.html">wrapper_cox_regression_treatment</a></span><span class="op">(</span><span class="va">data</span>, tte_var <span class="op">=</span> <span class="va">tte_var</span>, censor_var <span class="op">=</span> <span class="va">censor_var</span>,</span>
<span>    treatment_var <span class="op">=</span> <span class="va">treatment_var</span>, biomarker_vars <span class="op">=</span> <span class="va">biomarker_vars</span>, adjustment_vars <span class="op">=</span> <span class="va">adjustment_vars</span>,</span>
<span>    print_total <span class="op">=</span> <span class="cn">FALSE</span>, print_adjpvalues <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/Bclass-class.html">bforest</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/cox_regression-2.png" width="1920" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Treatment-biomarker interaction effect</span></span>
<span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span><span class="va">tte_var</span> <span class="op">&lt;-</span> <span class="st">"PFS"</span></span>
<span><span class="va">censor_var</span> <span class="op">&lt;-</span> <span class="st">"PFS_Event"</span></span>
<span></span>
<span><span class="va">treatment_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span></span>
<span><span class="va">biomarker_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GeneA_cat2"</span>, <span class="st">"GeneA"</span><span class="op">)</span></span>
<span><span class="va">adjustment_vars</span> <span class="op">&lt;-</span> <span class="st">"IPI"</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_cox_regression_interaction.html">wrapper_cox_regression_interaction</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">tte_var</span>, <span class="va">censor_var</span>, treatment_var <span class="op">=</span> <span class="va">treatment_var</span>,</span>
<span>    biomarker_vars <span class="op">=</span> <span class="va">biomarker_vars</span>, adjustment_vars <span class="op">=</span> <span class="va">adjustment_vars</span><span class="op">)</span></span></code></pre></div>
<table class="table table table-condensed table-bordered" style="font-size: 9px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Effect of interaction between biomarker and treatment on PFS. Adjusted, unstratified analysis. Cox regression model includes: biomarker, treatment and IPI.
</caption>
<thead><tr>
<th style="text-align:left;">
Biomarker
</th>
<th style="text-align:left;">
Biomarker Effect
</th>
<th style="text-align:left;">
Treatment Effect
</th>
<th style="text-align:left;">
Total N
</th>
<th style="text-align:left;">
HR
</th>
<th style="text-align:left;">
HR 95% CI
</th>
<th style="text-align:left;">
P-value
</th>
<th style="text-align:left;">
Adj. P-value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
high vs low
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
TRT vs CTRL
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
400
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.92
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(0.50 - 1.70)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.7985
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.8593
</td>
</tr>
<tr>
<td style="text-align:left;">
GeneA
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
TRT vs CTRL
</td>
<td style="text-align:left;">
400
</td>
<td style="text-align:left;font-weight: bold;">
0.97
</td>
<td style="text-align:left;">
(0.72 - 1.32)
</td>
<td style="text-align:left;font-weight: bold;">
0.8593
</td>
<td style="text-align:left;font-weight: bold;">
0.8593
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="log-rank-test">Log-rank test<a class="anchor" aria-label="anchor" href="#log-rank-test"></a>
</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Biomarker effect</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span><span class="va">tte_var</span> <span class="op">&lt;-</span> <span class="st">"PFS"</span></span>
<span><span class="va">censor_var</span> <span class="op">&lt;-</span> <span class="st">"PFS_Event"</span></span>
<span></span>
<span><span class="va">biomarker_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GeneA_cat2"</span>, <span class="st">"GeneB_cat2"</span><span class="op">)</span></span>
<span><span class="va">treatment_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_log_rank_test_biomarker.html">wrapper_log_rank_test_biomarker</a></span><span class="op">(</span><span class="va">data</span>, tte_var <span class="op">=</span> <span class="va">tte_var</span>, censor_var <span class="op">=</span> <span class="va">censor_var</span>,</span>
<span>    biomarker_vars <span class="op">=</span> <span class="va">biomarker_vars</span>, treatment_var <span class="op">=</span> <span class="va">treatment_var</span><span class="op">)</span></span></code></pre></div>
<table class="table table table-condensed table-bordered" style="font-size: 9px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Biomarker effect on PFS. Unstratified log-rank test.
</caption>
<thead><tr>
<th style="text-align:left;">
Treatment Arm
</th>
<th style="text-align:left;">
Biomarker
</th>
<th style="text-align:left;">
Subgroup
</th>
<th style="text-align:left;">
Total N
</th>
<th style="text-align:left;">
Total Events
</th>
<th style="text-align:left;">
N
</th>
<th style="text-align:left;">
Events
</th>
<th style="text-align:left;">
MST
</th>
<th style="text-align:left;">
MST 95% CI
</th>
<th style="text-align:left;">
HR
</th>
<th style="text-align:left;">
HR 95% CI
</th>
<th style="text-align:left;">
P-value
</th>
<th style="text-align:left;">
Adj. P-value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
CTRL
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
low
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
204
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
85
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
104
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
41 (39.4%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
NA
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(76.9 - NA)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.8211
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.8917
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
high
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
204
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
85
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
100
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
44 (44.0%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
83.1
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(82.1 - NA)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
1.05
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(0.69 - 1.61)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
TRT
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
low
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
196
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
83
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
96
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
40 (41.7%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
99.9
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(82.2 - NA)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.8917
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.8917
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
high
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
196
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
83
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
100
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
43 (43.0%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
100.3
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(81.6 - NA)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.97
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(0.63 - 1.49)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
</tr>
<tr>
<td style="text-align:left;">
CTRL
</td>
<td style="text-align:left;">
GeneB cat2
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
204
</td>
<td style="text-align:left;">
85
</td>
<td style="text-align:left;">
96
</td>
<td style="text-align:left;">
35 (36.5%)
</td>
<td style="text-align:left;">
98.3
</td>
<td style="text-align:left;">
(82.6 - NA)
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;font-weight: bold;">
0.0120 *
</td>
<td style="text-align:left;font-weight: bold;">
0.0478 *
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
204
</td>
<td style="text-align:left;">
85
</td>
<td style="text-align:left;">
108
</td>
<td style="text-align:left;">
50 (46.3%)
</td>
<td style="text-align:left;">
80.4
</td>
<td style="text-align:left;">
(63.6 - NA)
</td>
<td style="text-align:left;font-weight: bold;">
1.73
</td>
<td style="text-align:left;">
(1.12 - 2.68)
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
</tr>
<tr>
<td style="text-align:left;">
TRT
</td>
<td style="text-align:left;">
GeneB cat2
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
196
</td>
<td style="text-align:left;">
83
</td>
<td style="text-align:left;">
104
</td>
<td style="text-align:left;">
38 (36.5%)
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
(91.0 - NA)
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;font-weight: bold;">
0.2437
</td>
<td style="text-align:left;font-weight: bold;">
0.4874
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
196
</td>
<td style="text-align:left;">
83
</td>
<td style="text-align:left;">
92
</td>
<td style="text-align:left;">
45 (48.9%)
</td>
<td style="text-align:left;">
87.5
</td>
<td style="text-align:left;">
(82.1 - NA)
</td>
<td style="text-align:left;font-weight: bold;">
1.29
</td>
<td style="text-align:left;">
(0.84 - 1.99)
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Treatment effect within biomarker subgroups</span></span>
<span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span><span class="va">tte_var</span> <span class="op">&lt;-</span> <span class="st">"PFS"</span></span>
<span><span class="va">censor_var</span> <span class="op">&lt;-</span> <span class="st">"PFS_Event"</span></span>
<span></span>
<span><span class="va">treatment_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span></span>
<span><span class="va">biomarker_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GeneA_cat2"</span>, <span class="st">"GeneB_cat2"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_log_rank_test_treatment.html">wrapper_log_rank_test_treatment</a></span><span class="op">(</span><span class="va">data</span>, tte_var <span class="op">=</span> <span class="va">tte_var</span>, censor_var <span class="op">=</span> <span class="va">censor_var</span>,</span>
<span>    treatment_var <span class="op">=</span> <span class="va">treatment_var</span>, biomarker_vars <span class="op">=</span> <span class="va">biomarker_vars</span><span class="op">)</span></span></code></pre></div>
<table class="table table table-condensed table-bordered" style="font-size: 9px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Treatment effect on PFS. Unstratified log-rank test.
</caption>
<thead><tr>
<th style="text-align:left;">
Biomarker
</th>
<th style="text-align:left;">
Biomarker Subgroup
</th>
<th style="text-align:left;">
Treatment Subgroup
</th>
<th style="text-align:left;">
Total N
</th>
<th style="text-align:left;">
Total Events
</th>
<th style="text-align:left;">
N
</th>
<th style="text-align:left;">
Events
</th>
<th style="text-align:left;">
MST
</th>
<th style="text-align:left;">
MST 95% CI
</th>
<th style="text-align:left;">
HR
</th>
<th style="text-align:left;">
HR 95% CI
</th>
<th style="text-align:left;">
P-value
</th>
<th style="text-align:left;">
Adj. P-value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
low
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
CTRL
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
200
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
81
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
104
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
41 (39.4%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
NA
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(76.9 - NA)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.5693
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.7591
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
TRT
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
200
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
81
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
96
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
40 (41.7%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
99.9
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(82.2 - NA)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.88
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(0.57 - 1.37)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
high
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
CTRL
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
200
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
87
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
100
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
44 (44.0%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
83.1
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(82.1 - NA)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.2526
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.5052
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
TRT
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
200
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
87
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
100
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
43 (43.0%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
100.3
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(81.6 - NA)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.78
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(0.51 - 1.19)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
</tr>
<tr>
<td style="text-align:left;">
GeneB cat2
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
CTRL
</td>
<td style="text-align:left;">
200
</td>
<td style="text-align:left;">
73
</td>
<td style="text-align:left;">
96
</td>
<td style="text-align:left;">
35 (36.5%)
</td>
<td style="text-align:left;">
98.3
</td>
<td style="text-align:left;">
(82.6 - NA)
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;font-weight: bold;">
0.9213
</td>
<td style="text-align:left;font-weight: bold;">
0.9213
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
TRT
</td>
<td style="text-align:left;">
200
</td>
<td style="text-align:left;">
73
</td>
<td style="text-align:left;">
104
</td>
<td style="text-align:left;">
38 (36.5%)
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
(91.0 - NA)
</td>
<td style="text-align:left;font-weight: bold;">
0.98
</td>
<td style="text-align:left;">
(0.62 - 1.55)
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
</tr>
<tr>
<td style="text-align:left;">
GeneB cat2
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
CTRL
</td>
<td style="text-align:left;">
200
</td>
<td style="text-align:left;">
95
</td>
<td style="text-align:left;">
108
</td>
<td style="text-align:left;">
50 (46.3%)
</td>
<td style="text-align:left;">
80.4
</td>
<td style="text-align:left;">
(63.6 - NA)
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;font-weight: bold;">
0.0893 .
</td>
<td style="text-align:left;font-weight: bold;">
0.3574
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
TRT
</td>
<td style="text-align:left;">
200
</td>
<td style="text-align:left;">
95
</td>
<td style="text-align:left;">
92
</td>
<td style="text-align:left;">
45 (48.9%)
</td>
<td style="text-align:left;">
87.5
</td>
<td style="text-align:left;">
(82.1 - NA)
</td>
<td style="text-align:left;font-weight: bold;">
0.70
</td>
<td style="text-align:left;">
(0.47 - 1.06)
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wrapper_log_rank_test_treatment.html">wrapper_log_rank_test_treatment</a></span><span class="op">(</span><span class="va">data</span>, tte_var <span class="op">=</span> <span class="va">tte_var</span>, censor_var <span class="op">=</span> <span class="va">censor_var</span>,</span>
<span>    treatment_var <span class="op">=</span> <span class="va">treatment_var</span>, biomarker_vars <span class="op">=</span> <span class="va">biomarker_vars</span>, print_nevent <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    print_mst <span class="op">=</span> <span class="cn">FALSE</span>, print_total <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/Bclass-class.html">bkable</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<table class="table table table-condensed table-bordered" style="font-size: 9px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Treatment effect on PFS. Unstratified log-rank test.
</caption>
<thead><tr>
<th style="text-align:left;">
Biomarker
</th>
<th style="text-align:left;">
Biomarker Subgroup
</th>
<th style="text-align:left;">
Treatment Subgroup
</th>
<th style="text-align:left;">
N
</th>
<th style="text-align:left;">
HR
</th>
<th style="text-align:left;">
HR 95% CI
</th>
<th style="text-align:left;">
P-value
</th>
<th style="text-align:left;">
Adj. P-value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
low
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
CTRL
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
104
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.5693
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.7591
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
TRT
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
96
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.88
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(0.57 - 1.37)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
high
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
CTRL
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
100
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.2526
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.5052
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
TRT
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
100
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.78
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(0.51 - 1.19)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
</tr>
<tr>
<td style="text-align:left;">
GeneB cat2
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
CTRL
</td>
<td style="text-align:left;">
96
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;font-weight: bold;">
0.9213
</td>
<td style="text-align:left;font-weight: bold;">
0.9213
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
TRT
</td>
<td style="text-align:left;">
104
</td>
<td style="text-align:left;font-weight: bold;">
0.98
</td>
<td style="text-align:left;">
(0.62 - 1.55)
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
</tr>
<tr>
<td style="text-align:left;">
GeneB cat2
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
CTRL
</td>
<td style="text-align:left;">
108
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;font-weight: bold;">
0.0893 .
</td>
<td style="text-align:left;font-weight: bold;">
0.3574
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
TRT
</td>
<td style="text-align:left;">
92
</td>
<td style="text-align:left;font-weight: bold;">
0.70
</td>
<td style="text-align:left;">
(0.47 - 1.06)
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/Bclass-class.html">bforest</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/log_rank_test-1.png" width="1920" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="km-plot">KM plot<a class="anchor" aria-label="anchor" href="#km-plot"></a>
</h2>
<div class="section level3">
<h3 id="core">Core<a class="anchor" aria-label="anchor" href="#core"></a>
</h3>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span></span>
<span><span class="va">tte_var</span> <span class="op">&lt;-</span> <span class="st">"PFS"</span></span>
<span><span class="va">censor_var</span> <span class="op">&lt;-</span> <span class="st">"PFS_Event"</span></span>
<span><span class="va">covariate_var</span> <span class="op">&lt;-</span> <span class="st">"Treatment_Arm"</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_KM_plot_core.html">wrapper_KM_plot_core</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, tte_var <span class="op">=</span> <span class="va">tte_var</span>, censor_var <span class="op">=</span> <span class="va">censor_var</span>, covariate_var <span class="op">=</span> <span class="va">covariate_var</span><span class="op">)</span></span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/KM_plot-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="core-stratified">Core stratified<a class="anchor" aria-label="anchor" href="#core-stratified"></a>
</h3>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span><span class="va">tte_var</span> <span class="op">&lt;-</span> <span class="st">"PFS"</span></span>
<span><span class="va">censor_var</span> <span class="op">&lt;-</span> <span class="st">"PFS_Event"</span></span>
<span><span class="va">covariate_var</span> <span class="op">&lt;-</span> <span class="st">"GeneA_cat2"</span></span>
<span></span>
<span><span class="va">strat1_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span></span>
<span><span class="va">strat2_var</span> <span class="op">=</span> <span class="st">"Cell_Of_Origin"</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_KM_plot_core.html">wrapper_KM_plot_core_strat</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, tte_var <span class="op">=</span> <span class="va">tte_var</span>, censor_var <span class="op">=</span> <span class="va">censor_var</span>,</span>
<span>    covariate_var <span class="op">=</span> <span class="va">covariate_var</span>, strat1_var <span class="op">=</span> <span class="va">strat1_var</span>, strat2_var <span class="op">=</span> <span class="va">strat2_var</span>,</span>
<span>    linetypes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/KM_plot_strat-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="display-tables-with-cox-regression-results">Display tables with Cox regression results<a class="anchor" aria-label="anchor" href="#display-tables-with-cox-regression-results"></a>
</h3>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Display results from Cox regression as table on the KM plot</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span></span>
<span><span class="va">tte_var</span> <span class="op">&lt;-</span> <span class="st">"PFS"</span></span>
<span><span class="va">censor_var</span> <span class="op">&lt;-</span> <span class="st">"PFS_Event"</span></span>
<span><span class="va">biomarker_var</span> <span class="op">&lt;-</span> <span class="st">"GeneA_cat2"</span></span>
<span></span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wrapper_cox_regression_biomarker.html">wrapper_cox_regression_biomarker</a></span><span class="op">(</span><span class="va">data</span>, tte_var <span class="op">=</span> <span class="va">tte_var</span>, censor_var <span class="op">=</span> <span class="va">censor_var</span>,</span>
<span>    biomarker_vars <span class="op">=</span> <span class="va">biomarker_var</span>, print_total <span class="op">=</span> <span class="cn">FALSE</span>, print_adjpvalues <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">tb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Bclass-class.html">boutput</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">tb</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="fl">1</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">tb</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">ggp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wrapper_KM_plot_core.html">wrapper_KM_plot_core</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, tte_var <span class="op">=</span> <span class="va">tte_var</span>, censor_var <span class="op">=</span> <span class="va">censor_var</span>,</span>
<span>    covariate_var <span class="op">=</span> <span class="va">biomarker_var</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ggp</span> <span class="op">+</span> <span class="fu">ggpp</span><span class="fu">::</span><span class="fu"><a href="https://docs.r4photobiology.info/ggpp/reference/geom_table.html" class="external-link">geom_table_npc</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">tb</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>npcx <span class="op">=</span> <span class="va">x</span>, npcy <span class="op">=</span> <span class="va">y</span>, label <span class="op">=</span> <span class="va">label</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    hjust <span class="op">=</span> <span class="fl">1</span>, vjust <span class="op">=</span> <span class="fl">1</span>, table.theme <span class="op">=</span> <span class="fu">ggpp</span><span class="fu">::</span><span class="va"><a href="https://docs.r4photobiology.info/ggpp/reference/ttheme_gtdefault.html" class="external-link">ttheme_gtminimal</a></span><span class="op">)</span></span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/unnamed-chunk-3-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Display results from Cox regression as table on the KM plot using one-level</span></span>
<span><span class="co">### stratification</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span></span>
<span><span class="va">tte_var</span> <span class="op">&lt;-</span> <span class="st">"PFS"</span></span>
<span><span class="va">censor_var</span> <span class="op">&lt;-</span> <span class="st">"PFS_Event"</span></span>
<span><span class="va">biomarker_var</span> <span class="op">&lt;-</span> <span class="st">"GeneA_cat2"</span></span>
<span><span class="va">treatment_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span></span>
<span></span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wrapper_cox_regression_biomarker.html">wrapper_cox_regression_biomarker</a></span><span class="op">(</span><span class="va">data</span>, tte_var <span class="op">=</span> <span class="va">tte_var</span>, censor_var <span class="op">=</span> <span class="va">censor_var</span>,</span>
<span>    biomarker_vars <span class="op">=</span> <span class="va">biomarker_var</span>, treatment_var <span class="op">=</span> <span class="va">treatment_var</span>, print_total <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    print_adjpvalues <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">### To have the same level order</span></span>
<span></span>
<span><span class="fu"><a href="../reference/Bclass-class.html">bresults</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[[</span><span class="va">treatment_var</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="../reference/Bclass-class.html">bresults</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[[</span><span class="va">treatment_var</span><span class="op">]</span><span class="op">]</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>,</span>
<span>    <span class="va">treatment_var</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">tb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Bclass-class.html">boutput</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">tb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">tb</span>, <span class="fu"><a href="../reference/Bclass-class.html">bresults</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[[</span><span class="va">treatment_var</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tb</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nlevels.html" class="external-link">nlevels</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>, <span class="va">treatment_var</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nlevels.html" class="external-link">nlevels</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>, <span class="va">treatment_var</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="fl">1</span>, label <span class="op">=</span> <span class="va">tb</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">ggp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wrapper_KM_plot_core.html">wrapper_KM_plot_core_strat</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, tte_var <span class="op">=</span> <span class="va">tte_var</span>, censor_var <span class="op">=</span> <span class="va">censor_var</span>,</span>
<span>    covariate_var <span class="op">=</span> <span class="va">biomarker_var</span>, strat1_var <span class="op">=</span> <span class="va">treatment_var</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ggp</span> <span class="op">+</span> <span class="fu">ggpp</span><span class="fu">::</span><span class="fu"><a href="https://docs.r4photobiology.info/ggpp/reference/geom_table.html" class="external-link">geom_table_npc</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">tb</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>npcx <span class="op">=</span> <span class="va">x</span>, npcy <span class="op">=</span> <span class="va">y</span>, label <span class="op">=</span> <span class="va">label</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    hjust <span class="op">=</span> <span class="fl">1</span>, vjust <span class="op">=</span> <span class="fl">1</span>, table.theme <span class="op">=</span> <span class="fu">ggpp</span><span class="fu">::</span><span class="va"><a href="https://docs.r4photobiology.info/ggpp/reference/ttheme_gtdefault.html" class="external-link">ttheme_gtminimal</a></span><span class="op">)</span></span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/unnamed-chunk-4-1.png" width="1344" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Display results from Cox regression as table on the KM plot using two-level</span></span>
<span><span class="co">### stratification</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span></span>
<span><span class="va">tte_var</span> <span class="op">&lt;-</span> <span class="st">"PFS"</span></span>
<span><span class="va">censor_var</span> <span class="op">&lt;-</span> <span class="st">"PFS_Event"</span></span>
<span><span class="va">biomarker_var</span> <span class="op">&lt;-</span> <span class="st">"GeneA_cat2"</span></span>
<span><span class="va">treatment_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span></span>
<span></span>
<span><span class="va">strat2_var</span> <span class="op">&lt;-</span> <span class="st">"Cell_Of_Origin"</span></span>
<span></span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wrapper_cox_regression_biomarker.html">wrapper_cox_regression_biomarker</a></span><span class="op">(</span><span class="va">data</span>, tte_var <span class="op">=</span> <span class="va">tte_var</span>, censor_var <span class="op">=</span> <span class="va">censor_var</span>,</span>
<span>    biomarker_vars <span class="op">=</span> <span class="va">biomarker_var</span>, treatment_var <span class="op">=</span> <span class="va">treatment_var</span>, strat2_var <span class="op">=</span> <span class="va">strat2_var</span>,</span>
<span>    print_total <span class="op">=</span> <span class="cn">FALSE</span>, print_adjpvalues <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">### To have the same level order</span></span>
<span></span>
<span><span class="fu"><a href="../reference/Bclass-class.html">bresults</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[[</span><span class="va">treatment_var</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="../reference/Bclass-class.html">bresults</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[[</span><span class="va">treatment_var</span><span class="op">]</span><span class="op">]</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>,</span>
<span>    <span class="va">treatment_var</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/Bclass-class.html">bresults</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[[</span><span class="va">strat2_var</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="../reference/Bclass-class.html">bresults</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[[</span><span class="va">strat2_var</span><span class="op">]</span><span class="op">]</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>,</span>
<span>    <span class="va">strat2_var</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">tb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Bclass-class.html">boutput</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">tb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">tb</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="../reference/Bclass-class.html">bresults</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[[</span><span class="va">treatment_var</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="../reference/Bclass-class.html">bresults</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[[</span><span class="va">strat2_var</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tb</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nlevels.html" class="external-link">nlevels</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>, <span class="va">treatment_var</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nlevels.html" class="external-link">nlevels</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>,</span>
<span>    <span class="va">treatment_var</span><span class="op">]</span><span class="op">)</span>, times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nlevels.html" class="external-link">nlevels</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>, <span class="va">strat2_var</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nlevels.html" class="external-link">nlevels</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>,</span>
<span>    <span class="va">strat2_var</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nlevels.html" class="external-link">nlevels</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>, <span class="va">strat2_var</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nlevels.html" class="external-link">nlevels</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>, <span class="va">treatment_var</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    label <span class="op">=</span> <span class="va">tb</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">ggp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wrapper_KM_plot_core.html">wrapper_KM_plot_core_strat</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, tte_var <span class="op">=</span> <span class="va">tte_var</span>, censor_var <span class="op">=</span> <span class="va">censor_var</span>,</span>
<span>    covariate_var <span class="op">=</span> <span class="va">biomarker_var</span>, strat1_var <span class="op">=</span> <span class="va">treatment_var</span>, strat2_var <span class="op">=</span> <span class="va">strat2_var</span>,</span>
<span>    strat1_label_both <span class="op">=</span> <span class="cn">FALSE</span>, strat2_label_both <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ggp</span> <span class="op">+</span> <span class="fu">ggpp</span><span class="fu">::</span><span class="fu"><a href="https://docs.r4photobiology.info/ggpp/reference/geom_table.html" class="external-link">geom_table_npc</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">tb</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>npcx <span class="op">=</span> <span class="va">x</span>, npcy <span class="op">=</span> <span class="va">y</span>, label <span class="op">=</span> <span class="va">label</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    hjust <span class="op">=</span> <span class="fl">1</span>, vjust <span class="op">=</span> <span class="fl">1</span>, table.theme <span class="op">=</span> <span class="fu">ggpp</span><span class="fu">::</span><span class="va"><a href="https://docs.r4photobiology.info/ggpp/reference/ttheme_gtdefault.html" class="external-link">ttheme_gtminimal</a></span><span class="op">)</span></span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/unnamed-chunk-5-1.png" width="1344" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="curves-per-treatment-arm-and-biomarker-subgroups-in-one-plot">Curves per treatment arm and biomarker subgroups in one plot<a class="anchor" aria-label="anchor" href="#curves-per-treatment-arm-and-biomarker-subgroups-in-one-plot"></a>
</h3>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span><span class="va">tte_var</span> <span class="op">&lt;-</span> <span class="st">"PFS"</span></span>
<span><span class="va">censor_var</span> <span class="op">&lt;-</span> <span class="st">"PFS_Event"</span></span>
<span></span>
<span><span class="va">biomarker_var</span> <span class="op">&lt;-</span> <span class="st">"GeneA_cat2"</span></span>
<span><span class="va">treatment_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_KM_plot_interaction.html">wrapper_KM_plot_interaction</a></span><span class="op">(</span><span class="va">data</span>, tte_var <span class="op">=</span> <span class="va">tte_var</span>, censor_var <span class="op">=</span> <span class="va">censor_var</span>, biomarker_var <span class="op">=</span> <span class="va">biomarker_var</span>,</span>
<span>    treatment_var <span class="op">=</span> <span class="va">treatment_var</span><span class="op">)</span></span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/KM_plot_interaction-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/wrapper_KM_plot_interaction.html">wrapper_KM_plot_interaction</a></span><span class="op">(</span><span class="va">data</span>, tte_var <span class="op">=</span> <span class="va">tte_var</span>, censor_var <span class="op">=</span> <span class="va">censor_var</span>, biomarker_var <span class="op">=</span> <span class="va">biomarker_var</span>,</span>
<span>    treatment_var <span class="op">=</span> <span class="va">treatment_var</span>, colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"blue2"</span>, <span class="st">"red"</span>, <span class="st">"red2"</span><span class="op">)</span>, linetypes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,</span>
<span>        <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, line_size <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/KM_plot_interaction-2.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="biomarker-effect-per-treatment-arm">Biomarker effect per treatment arm<a class="anchor" aria-label="anchor" href="#biomarker-effect-per-treatment-arm"></a>
</h3>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span><span class="va">tte_var</span> <span class="op">&lt;-</span> <span class="st">"PFS"</span></span>
<span><span class="va">censor_var</span> <span class="op">&lt;-</span> <span class="st">"PFS_Event"</span></span>
<span></span>
<span><span class="va">biomarker_var</span> <span class="op">&lt;-</span> <span class="st">"GeneA_cat2"</span></span>
<span><span class="va">treatment_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_KM_plot_biomarker.html">wrapper_KM_plot_biomarker</a></span><span class="op">(</span><span class="va">data</span>, tte_var <span class="op">=</span> <span class="va">tte_var</span>, censor_var <span class="op">=</span> <span class="va">censor_var</span>, biomarker_var <span class="op">=</span> <span class="va">biomarker_var</span>,</span>
<span>    treatment_var <span class="op">=</span> <span class="va">treatment_var</span><span class="op">)</span></span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/KM_plot_biomarker-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="treatment-effect-per-biomarker-subgroup">Treatment effect per biomarker subgroup<a class="anchor" aria-label="anchor" href="#treatment-effect-per-biomarker-subgroup"></a>
</h3>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span><span class="va">tte_var</span> <span class="op">&lt;-</span> <span class="st">"PFS"</span></span>
<span><span class="va">censor_var</span> <span class="op">&lt;-</span> <span class="st">"PFS_Event"</span></span>
<span></span>
<span><span class="va">biomarker_var</span> <span class="op">&lt;-</span> <span class="st">"GeneA_cat2"</span></span>
<span><span class="va">treatment_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_KM_plot_treatment.html">wrapper_KM_plot_treatment</a></span><span class="op">(</span><span class="va">data</span>, tte_var <span class="op">=</span> <span class="va">tte_var</span>, censor_var <span class="op">=</span> <span class="va">censor_var</span>, biomarker_var <span class="op">=</span> <span class="va">biomarker_var</span>,</span>
<span>    treatment_var <span class="op">=</span> <span class="va">treatment_var</span><span class="op">)</span></span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/KM_plot_treatment-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="logistic-regression">Logistic regression<a class="anchor" aria-label="anchor" href="#logistic-regression"></a>
</h2>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Biomarker effect</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span><span class="va">response_var</span> <span class="op">&lt;-</span> <span class="st">"ORR"</span></span>
<span></span>
<span><span class="va">biomarker_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GeneA_cat2"</span>, <span class="st">"GeneA"</span><span class="op">)</span></span>
<span><span class="va">treatment_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span></span>
<span><span class="va">adjustment_vars</span> <span class="op">&lt;-</span> <span class="st">"IPI"</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_logistic_regression_biomarker.html">wrapper_logistic_regression_biomarker</a></span><span class="op">(</span><span class="va">data</span>, response_var <span class="op">=</span> <span class="va">response_var</span>, biomarker_vars <span class="op">=</span> <span class="va">biomarker_vars</span>,</span>
<span>    adjustment_vars <span class="op">=</span> <span class="va">adjustment_vars</span>, treatment_var <span class="op">=</span> <span class="va">treatment_var</span><span class="op">)</span></span></code></pre></div>
<table class="table table table-condensed table-bordered" style="font-size: 9px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Biomarker effect on ORR. Adjusted analysis. Logistic regression model includes the biomarker and IPI.
</caption>
<thead><tr>
<th style="text-align:left;">
Treatment Arm
</th>
<th style="text-align:left;">
Biomarker
</th>
<th style="text-align:left;">
Subgroup
</th>
<th style="text-align:left;">
Total N
</th>
<th style="text-align:left;">
N
</th>
<th style="text-align:left;">
NR
</th>
<th style="text-align:left;">
R
</th>
<th style="text-align:left;">
R 95% CI
</th>
<th style="text-align:left;">
OR
</th>
<th style="text-align:left;">
OR 95% CI
</th>
<th style="text-align:left;">
P-value
</th>
<th style="text-align:left;">
Adj. P-value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
CTRL
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
low
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
204
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
104
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
14 (13.5%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
90 (86.5%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(78.45 - 92.44)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
high
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
204
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
100
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
17 (17.0%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
83 (83.0%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(74.18 - 89.77)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.83
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(0.38 - 1.83)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.6467
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.6467
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
TRT
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
low
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
196
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
96
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
18 (18.8%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
78 (81.2%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(72.00 - 88.49)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
high
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
196
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
100
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
15 (15.0%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
85 (85.0%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(76.47 - 91.35)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
1.32
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(0.62 - 2.84)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.4706
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.6275
</td>
</tr>
<tr>
<td style="text-align:left;">
CTRL
</td>
<td style="text-align:left;">
GeneA
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
204
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;font-weight: bold;">
0.86
</td>
<td style="text-align:left;">
(0.60 - 1.25)
</td>
<td style="text-align:left;font-weight: bold;">
0.4412
</td>
<td style="text-align:left;font-weight: bold;">
0.6275
</td>
</tr>
<tr>
<td style="text-align:left;">
TRT
</td>
<td style="text-align:left;">
GeneA
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
196
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;font-weight: bold;">
1.21
</td>
<td style="text-align:left;">
(0.80 - 1.83)
</td>
<td style="text-align:left;font-weight: bold;">
0.3735
</td>
<td style="text-align:left;font-weight: bold;">
0.6275
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Treatment effect within biomarker subgroups</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span><span class="va">response_var</span> <span class="op">&lt;-</span> <span class="st">"ORR"</span></span>
<span></span>
<span><span class="va">treatment_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span></span>
<span><span class="va">biomarker_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GeneA_cat2"</span>, <span class="st">"GeneB_cat2"</span><span class="op">)</span></span>
<span><span class="va">adjustment_vars</span> <span class="op">&lt;-</span> <span class="st">"IPI"</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_logistic_regression_treatment.html">wrapper_logistic_regression_treatment</a></span><span class="op">(</span><span class="va">data</span>, response_var <span class="op">=</span> <span class="va">response_var</span>, treatment_var <span class="op">=</span> <span class="va">treatment_var</span>,</span>
<span>    biomarker_vars <span class="op">=</span> <span class="va">biomarker_vars</span>, adjustment_vars <span class="op">=</span> <span class="va">adjustment_vars</span><span class="op">)</span></span></code></pre></div>
<table class="table table table-condensed table-bordered" style="font-size: 9px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Treatment effect on ORR. Adjusted analysis. Logistic regression model includes the treatment and IPI.
</caption>
<thead><tr>
<th style="text-align:left;">
Biomarker
</th>
<th style="text-align:left;">
Biomarker Subgroup
</th>
<th style="text-align:left;">
Treatment Subgroup
</th>
<th style="text-align:left;">
Total N
</th>
<th style="text-align:left;">
N
</th>
<th style="text-align:left;">
NR
</th>
<th style="text-align:left;">
R
</th>
<th style="text-align:left;">
R 95% CI
</th>
<th style="text-align:left;">
OR
</th>
<th style="text-align:left;">
OR 95% CI
</th>
<th style="text-align:left;">
P-value
</th>
<th style="text-align:left;">
Adj. P-value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
low
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
CTRL
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
200
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
104
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
14 (13.5%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
90 (86.5%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(78.45 - 92.44)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
TRT
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
200
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
96
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
18 (18.8%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
78 (81.2%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(72.00 - 88.49)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.67
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(0.31 - 1.44)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.3098
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.6195
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
high
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
CTRL
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
200
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
100
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
17 (17.0%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
83 (83.0%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(74.18 - 89.77)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
TRT
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
200
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
100
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
15 (15.0%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
85 (85.0%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(76.47 - 91.35)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
1.27
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(0.58 - 2.79)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.5434
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.6679
</td>
</tr>
<tr>
<td style="text-align:left;">
GeneB cat2
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
CTRL
</td>
<td style="text-align:left;">
200
</td>
<td style="text-align:left;">
96
</td>
<td style="text-align:left;">
8 (8.3%)
</td>
<td style="text-align:left;">
88 (91.7%)
</td>
<td style="text-align:left;">
(84.24 - 96.33)
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
TRT
</td>
<td style="text-align:left;">
200
</td>
<td style="text-align:left;">
104
</td>
<td style="text-align:left;">
15 (14.4%)
</td>
<td style="text-align:left;">
89 (85.6%)
</td>
<td style="text-align:left;">
(77.33 - 91.70)
</td>
<td style="text-align:left;font-weight: bold;">
0.57
</td>
<td style="text-align:left;">
(0.22 - 1.42)
</td>
<td style="text-align:left;font-weight: bold;">
0.2261
</td>
<td style="text-align:left;font-weight: bold;">
0.6195
</td>
</tr>
<tr>
<td style="text-align:left;">
GeneB cat2
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
CTRL
</td>
<td style="text-align:left;">
200
</td>
<td style="text-align:left;">
108
</td>
<td style="text-align:left;">
23 (21.3%)
</td>
<td style="text-align:left;">
85 (78.7%)
</td>
<td style="text-align:left;">
(69.78 - 86.00)
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
TRT
</td>
<td style="text-align:left;">
200
</td>
<td style="text-align:left;">
92
</td>
<td style="text-align:left;">
18 (19.6%)
</td>
<td style="text-align:left;">
74 (80.4%)
</td>
<td style="text-align:left;">
(70.85 - 87.97)
</td>
<td style="text-align:left;font-weight: bold;">
1.17
</td>
<td style="text-align:left;">
(0.58 - 2.36)
</td>
<td style="text-align:left;font-weight: bold;">
0.6679
</td>
<td style="text-align:left;font-weight: bold;">
0.6679
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Treatment-biomarker interaction effect</span></span>
<span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span><span class="va">response_var</span> <span class="op">&lt;-</span> <span class="st">"ORR"</span></span>
<span></span>
<span><span class="va">treatment_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span></span>
<span><span class="va">biomarker_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GeneA_cat2"</span>, <span class="st">"GeneA"</span><span class="op">)</span></span>
<span><span class="va">adjustment_vars</span> <span class="op">&lt;-</span> <span class="st">"IPI"</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_logistic_regression_interaction.html">wrapper_logistic_regression_interaction</a></span><span class="op">(</span><span class="va">data</span>, response_var <span class="op">=</span> <span class="va">response_var</span>, treatment_var <span class="op">=</span> <span class="va">treatment_var</span>,</span>
<span>    biomarker_vars <span class="op">=</span> <span class="va">biomarker_vars</span>, adjustment_vars <span class="op">=</span> <span class="va">adjustment_vars</span><span class="op">)</span></span></code></pre></div>
<table class="table table table-condensed table-bordered" style="font-size: 9px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Effect of interaction between biomarker and treatment on ORR.Adjusted analysis. Logistic regression model includes the biomarker, treatment and IPI.
</caption>
<thead><tr>
<th style="text-align:left;">
Biomarker
</th>
<th style="text-align:left;">
Biomarker Effect
</th>
<th style="text-align:left;">
Treatment Effect
</th>
<th style="text-align:left;">
Total n
</th>
<th style="text-align:left;">
OR
</th>
<th style="text-align:left;">
OR 95% CI
</th>
<th style="text-align:left;">
P-value
</th>
<th style="text-align:left;">
Adj. P-value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
high vs low
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
TRT vs CTRL
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
400
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
1.83
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(0.62 - 5.39)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.2766
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.2766
</td>
</tr>
<tr>
<td style="text-align:left;">
GeneA
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
TRT vs CTRL
</td>
<td style="text-align:left;">
400
</td>
<td style="text-align:left;font-weight: bold;">
1.42
</td>
<td style="text-align:left;">
(0.82 - 2.48)
</td>
<td style="text-align:left;font-weight: bold;">
0.2113
</td>
<td style="text-align:left;font-weight: bold;">
0.2766
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="pearsons-test">Pearson’s test<a class="anchor" aria-label="anchor" href="#pearsons-test"></a>
</h2>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Biomarker effect</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span><span class="va">response_var</span> <span class="op">&lt;-</span> <span class="st">"ORR"</span></span>
<span></span>
<span><span class="va">biomarker_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GeneA_cat2"</span><span class="op">)</span></span>
<span><span class="va">treatment_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_pearsons_test_biomarker.html">wrapper_pearsons_test_biomarker</a></span><span class="op">(</span><span class="va">data</span>, response_var <span class="op">=</span> <span class="va">response_var</span>, biomarker_vars <span class="op">=</span> <span class="va">biomarker_vars</span>,</span>
<span>    treatment_var <span class="op">=</span> <span class="va">treatment_var</span><span class="op">)</span></span></code></pre></div>
<table class="table table table-condensed table-bordered" style="font-size: 9px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Biomarker effect on ORR. Unstratified Pearson’s Chi-squared test.
</caption>
<thead><tr>
<th style="text-align:left;">
Treatment Arm
</th>
<th style="text-align:left;">
Biomarker
</th>
<th style="text-align:left;">
Subgroup
</th>
<th style="text-align:left;">
Total N
</th>
<th style="text-align:left;">
N
</th>
<th style="text-align:left;">
NR
</th>
<th style="text-align:left;">
R
</th>
<th style="text-align:left;">
R 95% CI
</th>
<th style="text-align:left;">
Difference
</th>
<th style="text-align:left;">
Difference 95% CI
</th>
<th style="text-align:left;">
P-value
</th>
<th style="text-align:left;">
Adj. P-value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
CTRL
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
low
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
204
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
104
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
14 (13.5%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
90 (86.5%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(78.45 - 92.44)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
-3.54
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(-14.38 - 7.30)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.6110
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.6110
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
high
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
204
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
100
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
17 (17.0%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
83 (83.0%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(74.18 - 89.77)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
TRT
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
low
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
196
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
96
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
18 (18.8%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
78 (81.2%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(72.00 - 88.49)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
3.75
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(-7.76 - 15.26)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.6097
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.6110
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
high
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
196
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
100
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
15 (15.0%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
85 (85.0%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(76.47 - 91.35)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Treatment effect within biomarker subgroups</span></span>
<span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span><span class="va">response_var</span> <span class="op">&lt;-</span> <span class="st">"ORR"</span></span>
<span></span>
<span><span class="va">biomarker_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GeneA_cat2"</span><span class="op">)</span></span>
<span><span class="va">treatment_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_pearsons_test_treatment.html">wrapper_pearsons_test_treatment</a></span><span class="op">(</span><span class="va">data</span>, response_var <span class="op">=</span> <span class="va">response_var</span>, biomarker_vars <span class="op">=</span> <span class="va">biomarker_vars</span>,</span>
<span>    treatment_var <span class="op">=</span> <span class="va">treatment_var</span><span class="op">)</span></span></code></pre></div>
<table class="table table table-condensed table-bordered" style="font-size: 9px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Treatment effect on ORR. Unstratified Pearson’s Chi-squared test.
</caption>
<thead><tr>
<th style="text-align:left;">
Biomarker
</th>
<th style="text-align:left;">
Biomarker Subgroup
</th>
<th style="text-align:left;">
Treatment Subgroup
</th>
<th style="text-align:left;">
Total N
</th>
<th style="text-align:left;">
N
</th>
<th style="text-align:left;">
NR
</th>
<th style="text-align:left;">
R
</th>
<th style="text-align:left;">
R 95% CI
</th>
<th style="text-align:left;">
Difference
</th>
<th style="text-align:left;">
Difference 95% CI
</th>
<th style="text-align:left;">
P-value
</th>
<th style="text-align:left;">
Adj. P-value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
low
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
CTRL
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
200
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
104
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
14 (13.5%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
90 (86.5%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(78.45 - 92.44)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
-5.29
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(-16.49 - 5.91)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.4087
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.8174
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
TRT
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
200
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
96
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
18 (18.8%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
78 (81.2%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(72.00 - 88.49)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
high
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
CTRL
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
200
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
100
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
17 (17.0%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
83 (83.0%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(74.18 - 89.77)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
2.00
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(-9.16 - 13.16)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.8471
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.8471
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
TRT
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
200
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
100
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
15 (15.0%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
85 (85.0%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(76.47 - 91.35)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="cochran-mantel-haenszel-chi-squared-test">Cochran-Mantel-Haenszel Chi-Squared Test<a class="anchor" aria-label="anchor" href="#cochran-mantel-haenszel-chi-squared-test"></a>
</h2>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Biomarker effect</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span><span class="va">response_var</span> <span class="op">&lt;-</span> <span class="st">"ORR"</span></span>
<span></span>
<span><span class="va">biomarker_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GeneA_cat2"</span><span class="op">)</span></span>
<span><span class="va">treatment_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span></span>
<span><span class="va">strata_vars</span> <span class="op">&lt;-</span> <span class="st">"IPI"</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_pearsons_test_biomarker.html">wrapper_pearsons_test_biomarker</a></span><span class="op">(</span><span class="va">data</span>, response_var <span class="op">=</span> <span class="va">response_var</span>, biomarker_vars <span class="op">=</span> <span class="va">biomarker_vars</span>,</span>
<span>    treatment_var <span class="op">=</span> <span class="va">treatment_var</span>, strata_vars <span class="op">=</span> <span class="va">strata_vars</span><span class="op">)</span></span></code></pre></div>
<table class="table table table-condensed table-bordered" style="font-size: 9px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Biomarker effect on ORR. Stratified Cochran-Mantel-Haenszel Chi-squared test. Stratification factors: IPI.
</caption>
<thead><tr>
<th style="text-align:left;">
Treatment Arm
</th>
<th style="text-align:left;">
Biomarker
</th>
<th style="text-align:left;">
Subgroup
</th>
<th style="text-align:left;">
Total N
</th>
<th style="text-align:left;">
N
</th>
<th style="text-align:left;">
NR
</th>
<th style="text-align:left;">
R
</th>
<th style="text-align:left;">
R 95% CI
</th>
<th style="text-align:left;">
Difference
</th>
<th style="text-align:left;">
Difference 95% CI
</th>
<th style="text-align:left;">
P-value
</th>
<th style="text-align:left;">
Adj. P-value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
CTRL
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
low
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
204
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
104
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
14 (13.5%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
90 (86.5%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(78.45 - 92.44)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
-3.54
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(-14.38 - 7.30)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.7990
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.7990
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
high
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
204
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
100
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
17 (17.0%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
83 (83.0%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(74.18 - 89.77)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
TRT
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
low
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
196
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
96
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
18 (18.8%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
78 (81.2%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(72.00 - 88.49)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
3.75
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(-7.76 - 15.26)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.6010
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.7990
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
high
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
196
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
100
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
15 (15.0%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
85 (85.0%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(76.47 - 91.35)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Treatment effect within biomarker subgroups</span></span>
<span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span><span class="va">response_var</span> <span class="op">&lt;-</span> <span class="st">"ORR"</span></span>
<span></span>
<span><span class="va">biomarker_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GeneA_cat2"</span><span class="op">)</span></span>
<span><span class="va">treatment_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span></span>
<span><span class="va">strata_vars</span> <span class="op">&lt;-</span> <span class="st">"IPI"</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_pearsons_test_treatment.html">wrapper_pearsons_test_treatment</a></span><span class="op">(</span><span class="va">data</span>, response_var <span class="op">=</span> <span class="va">response_var</span>, biomarker_vars <span class="op">=</span> <span class="va">biomarker_vars</span>,</span>
<span>    treatment_var <span class="op">=</span> <span class="va">treatment_var</span>, strata_vars <span class="op">=</span> <span class="va">strata_vars</span><span class="op">)</span></span></code></pre></div>
<table class="table table table-condensed table-bordered" style="font-size: 9px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Treatment effect on ORR. Stratified Cochran-Mantel-Haenszel Chi-squared test. Stratification factors: IPI.
</caption>
<thead><tr>
<th style="text-align:left;">
Biomarker
</th>
<th style="text-align:left;">
Biomarker Subgroup
</th>
<th style="text-align:left;">
Treatment Subgroup
</th>
<th style="text-align:left;">
Total N
</th>
<th style="text-align:left;">
N
</th>
<th style="text-align:left;">
NR
</th>
<th style="text-align:left;">
R
</th>
<th style="text-align:left;">
R 95% CI
</th>
<th style="text-align:left;">
Difference
</th>
<th style="text-align:left;">
Difference 95% CI
</th>
<th style="text-align:left;">
P-value
</th>
<th style="text-align:left;">
Adj. P-value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
low
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
CTRL
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
200
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
104
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
14 (13.5%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
90 (86.5%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(78.45 - 92.44)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
-5.29
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(-16.49 - 5.91)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.4133
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.6850
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
TRT
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
200
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
96
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
18 (18.8%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
78 (81.2%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(72.00 - 88.49)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
high
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
CTRL
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
200
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
100
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
17 (17.0%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
83 (83.0%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(74.18 - 89.77)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
2.00
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(-9.16 - 13.16)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.6850
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.6850
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
TRT
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
200
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
100
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
15 (15.0%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
85 (85.0%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
(76.47 - 91.35)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="barplot-response">Barplot response<a class="anchor" aria-label="anchor" href="#barplot-response"></a>
</h2>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Biomarker effect</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span><span class="va">response_var</span> <span class="op">&lt;-</span> <span class="st">"ORR"</span></span>
<span></span>
<span><span class="va">biomarker_var</span> <span class="op">&lt;-</span> <span class="st">"GeneA_cat2"</span></span>
<span><span class="va">treatment_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_bar_plot_biomarker.html">wrapper_bar_plot_biomarker</a></span><span class="op">(</span><span class="va">data</span>, response_var <span class="op">=</span> <span class="va">response_var</span>, biomarker_var <span class="op">=</span> <span class="va">biomarker_var</span>,</span>
<span>    treatment_var <span class="op">=</span> <span class="va">treatment_var</span>, variable_names <span class="op">=</span> <span class="va">variable_names</span>, less_legends <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    ylab <span class="op">=</span> <span class="st">"ORR Proportion (%)"</span>, strat1_label_both <span class="op">=</span> <span class="cn">FALSE</span>, legend_colors_title <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/unnamed-chunk-6-1.png" width="1152" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Treatment effect</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span><span class="va">response_var</span> <span class="op">&lt;-</span> <span class="st">"ORR"</span></span>
<span></span>
<span><span class="va">biomarker_var</span> <span class="op">&lt;-</span> <span class="st">"GeneA_cat2"</span></span>
<span><span class="va">treatment_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_bar_plot_treatment.html">wrapper_bar_plot_treatment</a></span><span class="op">(</span><span class="va">data</span>, response_var <span class="op">=</span> <span class="va">response_var</span>, biomarker_var <span class="op">=</span> <span class="va">biomarker_var</span>,</span>
<span>    treatment_var <span class="op">=</span> <span class="va">treatment_var</span>, variable_names <span class="op">=</span> <span class="va">variable_names</span>, less_legends <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    ylab <span class="op">=</span> <span class="st">"R Proportion (%)"</span>, strat1_label_both <span class="op">=</span> <span class="cn">FALSE</span>, legend_colors_title <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    skip_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NR"</span><span class="op">)</span>, legend_position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/unnamed-chunk-7-1.png" width="768" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="barplot">Barplot<a class="anchor" aria-label="anchor" href="#barplot"></a>
</h2>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span></span>
<span><span class="va">x_var</span> <span class="op">=</span> <span class="st">"GeneA_cat2"</span></span>
<span><span class="va">y_var</span> <span class="op">=</span> <span class="st">"Response"</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_bar_plot_core.html">wrapper_bar_plot_core</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, x_var <span class="op">=</span> <span class="va">x_var</span>, y_var <span class="op">=</span> <span class="va">y_var</span><span class="op">)</span></span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/barplot-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/wrapper_bar_plot_core.html">wrapper_bar_plot_core</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, x_var <span class="op">=</span> <span class="va">x_var</span>, y_var <span class="op">=</span> <span class="va">y_var</span>, y_type <span class="op">=</span> <span class="st">"Count"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/barplot-2.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/wrapper_bar_plot_core.html">wrapper_bar_plot_core</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, x_var <span class="op">=</span> <span class="va">y_var</span>, y_var <span class="op">=</span> <span class="va">x_var</span>, y_type <span class="op">=</span> <span class="st">"Proportion"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/barplot-3.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/wrapper_bar_plot_core.html">wrapper_bar_plot_core</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, x_var <span class="op">=</span> <span class="va">y_var</span>, y_var <span class="op">=</span> <span class="va">x_var</span>, y_type <span class="op">=</span> <span class="st">"Count"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/barplot-4.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span></span>
<span><span class="va">x_var</span> <span class="op">=</span> <span class="st">"GeneA_cat2"</span></span>
<span><span class="va">y_var</span> <span class="op">=</span> <span class="st">"Response"</span></span>
<span><span class="va">skip_levels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NE"</span>, <span class="st">"PD"</span>, <span class="st">"SD"</span><span class="op">)</span></span>
<span><span class="va">show_subtotal_proportions</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_bar_plot_core.html">wrapper_bar_plot_core</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, x_var <span class="op">=</span> <span class="va">x_var</span>, y_var <span class="op">=</span> <span class="va">y_var</span>, show_subtotal_proportions <span class="op">=</span> <span class="va">show_subtotal_proportions</span>,</span>
<span>    skip_levels <span class="op">=</span> <span class="va">skip_levels</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/barplot-5.png" width="576" style="display: block; margin: auto;"></p>
<div class="section level3">
<h3 id="stratified">Stratified<a class="anchor" aria-label="anchor" href="#stratified"></a>
</h3>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span></span>
<span><span class="va">x_var</span> <span class="op">=</span> <span class="st">"GeneA_cat2"</span></span>
<span><span class="va">y_var</span> <span class="op">=</span> <span class="st">"Response"</span></span>
<span><span class="va">facet_var</span> <span class="op">&lt;-</span> <span class="st">"Treatment_Arm"</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_bar_plot_core.html">wrapper_bar_plot_core</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, x_var <span class="op">=</span> <span class="va">x_var</span>, y_var <span class="op">=</span> <span class="va">y_var</span>, facet_var <span class="op">=</span> <span class="va">facet_var</span><span class="op">)</span></span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/unnamed-chunk-8-1.png" width="960" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span></span>
<span><span class="va">x_var</span> <span class="op">=</span> <span class="st">"GeneA_cat2"</span></span>
<span><span class="va">y_var</span> <span class="op">=</span> <span class="st">"Response"</span></span>
<span></span>
<span><span class="va">strat1_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span></span>
<span><span class="va">strat2_var</span> <span class="op">=</span> <span class="st">"Cell_Of_Origin"</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_bar_plot_core.html">wrapper_bar_plot_core_strat</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, x_var <span class="op">=</span> <span class="va">x_var</span>, y_var <span class="op">=</span> <span class="va">y_var</span>, strat1_var <span class="op">=</span> <span class="va">strat1_var</span>,</span>
<span>    strat2_var <span class="op">=</span> <span class="va">strat2_var</span><span class="op">)</span></span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/unnamed-chunk-9-1.png" width="960" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/wrapper_bar_plot_core.html">wrapper_bar_plot_core_strat</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, x_var <span class="op">=</span> <span class="va">x_var</span>, y_var <span class="op">=</span> <span class="va">y_var</span>, strat1_var <span class="op">=</span> <span class="va">strat1_var</span>,</span>
<span>    strat2_var <span class="op">=</span> <span class="va">strat2_var</span>, less_legends <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/unnamed-chunk-9-2.png" width="960" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="complex-barplot">Complex barplot<a class="anchor" aria-label="anchor" href="#complex-barplot"></a>
</h2>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span></span>
<span><span class="va">x_var</span> <span class="op">&lt;-</span> <span class="st">"Cell_Of_Origin"</span></span>
<span><span class="va">y_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GeneA_cat2"</span>, <span class="st">"GeneB_cat2"</span>, <span class="st">"GeneC_cat2"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_bar_plot_yvars_core_strat.html">wrapper_bar_plot_yvars_core_strat</a></span><span class="op">(</span><span class="va">data</span>, x_var <span class="op">=</span> <span class="va">x_var</span>, y_vars <span class="op">=</span> <span class="va">y_vars</span>, values_to <span class="op">=</span> <span class="st">"Gene expression"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/Complex_barplot-1.png" width="960" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span></span>
<span><span class="va">x_var</span> <span class="op">&lt;-</span> <span class="st">"Cell_Of_Origin"</span></span>
<span><span class="va">y_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GeneA_cat2"</span>, <span class="st">"GeneB_cat2"</span>, <span class="st">"GeneC_cat2"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">skip_levels</span> <span class="op">&lt;-</span> <span class="st">"low"</span></span>
<span><span class="va">method</span> <span class="op">&lt;-</span> <span class="st">"dodge"</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_bar_plot_yvars_core_strat.html">wrapper_bar_plot_yvars_core_strat</a></span><span class="op">(</span><span class="va">data</span>, x_var <span class="op">=</span> <span class="va">x_var</span>, y_vars <span class="op">=</span> <span class="va">y_vars</span>, skip_levels <span class="op">=</span> <span class="va">skip_levels</span>,</span>
<span>    method <span class="op">=</span> <span class="va">method</span>, values_to <span class="op">=</span> <span class="st">"Gene expression"</span>, names_to <span class="op">=</span> <span class="st">"Gene"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/Complex_barplot-2.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="fishers-test">Fisher’s test<a class="anchor" aria-label="anchor" href="#fishers-test"></a>
</h2>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span></span>
<span><span class="va">col_var</span> <span class="op">&lt;-</span> <span class="st">"Cell_Of_Origin"</span></span>
<span><span class="va">row_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GeneA_cat2"</span>, <span class="st">"GeneB_cat2"</span>, <span class="st">"GeneC_cat2"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_fishers_test.html">wrapper_fishers_test</a></span><span class="op">(</span><span class="va">data</span>, col_var <span class="op">=</span> <span class="va">col_var</span>, row_vars <span class="op">=</span> <span class="va">row_vars</span><span class="op">)</span></span></code></pre></div>
<table class="table table table-condensed table-bordered" style="font-size: 9px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Fisher’s exact test.
</caption>
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="2">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Cell Of Origin
</div>
</th>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="2">
</th>
</tr>
<tr>
<th style="text-align:left;">
Covariate
</th>
<th style="text-align:left;">
Subgroup
</th>
<th style="text-align:left;">
GCB
</th>
<th style="text-align:left;">
UNCLASSIFIED
</th>
<th style="text-align:left;">
ABC
</th>
<th style="text-align:left;">
P-value
</th>
<th style="text-align:left;">
Adj. P-value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
low
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
116 (59.5%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
23 (11.8%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
56 (28.7%)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.0810 .
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.0810 .
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
high
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
102 (52.0%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
39 (19.9%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
55 (28.1%)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
</tr>
<tr>
<td style="text-align:left;">
GeneB cat2
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
124 (62.9%)
</td>
<td style="text-align:left;">
27 (13.7%)
</td>
<td style="text-align:left;">
46 (23.4%)
</td>
<td style="text-align:left;font-weight: bold;">
0.0156 *
</td>
<td style="text-align:left;font-weight: bold;">
0.0468 *
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
94 (48.5%)
</td>
<td style="text-align:left;">
35 (18.0%)
</td>
<td style="text-align:left;">
65 (33.5%)
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
GeneC cat2
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
low
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
109 (56.5%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
23 (11.9%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
61 (31.6%)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.0782 .
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.0810 .
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
high
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
109 (55.1%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
39 (19.7%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
50 (25.3%)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/wrapper_fishers_test.html">wrapper_fishers_test</a></span><span class="op">(</span><span class="va">data</span>, col_var <span class="op">=</span> <span class="va">col_var</span>, row_vars <span class="op">=</span> <span class="va">row_vars</span>, margin <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<table class="table table table-condensed table-bordered" style="font-size: 9px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Fisher’s exact test.
</caption>
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="2">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Cell Of Origin
</div>
</th>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="2">
</th>
</tr>
<tr>
<th style="text-align:left;">
Covariate
</th>
<th style="text-align:left;">
Subgroup
</th>
<th style="text-align:left;">
GCB
</th>
<th style="text-align:left;">
UNCLASSIFIED
</th>
<th style="text-align:left;">
ABC
</th>
<th style="text-align:left;">
P-value
</th>
<th style="text-align:left;">
Adj. P-value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
GeneA cat2
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
low
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
116 (53.2%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
23 (37.1%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
56 (50.5%)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.0810 .
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.0810 .
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
high
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
102 (46.8%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
39 (62.9%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
55 (49.5%)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
</tr>
<tr>
<td style="text-align:left;">
GeneB cat2
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
124 (56.9%)
</td>
<td style="text-align:left;">
27 (43.5%)
</td>
<td style="text-align:left;">
46 (41.4%)
</td>
<td style="text-align:left;font-weight: bold;">
0.0156 *
</td>
<td style="text-align:left;font-weight: bold;">
0.0468 *
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
94 (43.1%)
</td>
<td style="text-align:left;">
35 (56.5%)
</td>
<td style="text-align:left;">
65 (58.6%)
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
GeneC cat2
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
low
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
109 (50.0%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
23 (37.1%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
61 (55.0%)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.0782 .
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.0810 .
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
high
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
109 (50.0%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
39 (62.9%)
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
50 (45.0%)
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="box-plot">Box plot<a class="anchor" aria-label="anchor" href="#box-plot"></a>
</h2>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span></span>
<span><span class="va">x_var</span> <span class="op">&lt;-</span> <span class="st">"Cell_Of_Origin"</span></span>
<span><span class="va">y_var</span> <span class="op">&lt;-</span> <span class="st">"GeneA"</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_box_plot_core.html">wrapper_box_plot_core</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, x_var <span class="op">=</span> <span class="va">x_var</span>, y_var <span class="op">=</span> <span class="va">y_var</span><span class="op">)</span></span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/Box_plot-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="section level3">
<h3 id="stratified-1">Stratified<a class="anchor" aria-label="anchor" href="#stratified-1"></a>
</h3>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span></span>
<span><span class="va">x_var</span> <span class="op">&lt;-</span> <span class="st">"Cell_Of_Origin"</span></span>
<span><span class="va">y_var</span> <span class="op">&lt;-</span> <span class="st">"GeneA"</span></span>
<span><span class="va">facet_var</span> <span class="op">&lt;-</span> <span class="st">"Treatment_Arm"</span></span>
<span><span class="va">dodge_var</span> <span class="op">=</span> <span class="cn">NULL</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_box_plot_core.html">wrapper_box_plot_core</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, x_var <span class="op">=</span> <span class="va">x_var</span>, y_var <span class="op">=</span> <span class="va">y_var</span>, facet_var <span class="op">=</span> <span class="va">facet_var</span>,</span>
<span>    dodge_var <span class="op">=</span> <span class="va">dodge_var</span><span class="op">)</span></span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/Box_plot_strat-1.png" width="768" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span></span>
<span><span class="va">x_var</span> <span class="op">&lt;-</span> <span class="st">"Treatment_Arm"</span></span>
<span><span class="va">y_var</span> <span class="op">&lt;-</span> <span class="st">"GeneA"</span></span>
<span><span class="va">facet_var</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">dodge_var</span> <span class="op">=</span> <span class="st">"Cell_Of_Origin"</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_box_plot_core.html">wrapper_box_plot_core</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, x_var <span class="op">=</span> <span class="va">x_var</span>, y_var <span class="op">=</span> <span class="va">y_var</span>, facet_var <span class="op">=</span> <span class="va">facet_var</span>,</span>
<span>    dodge_var <span class="op">=</span> <span class="va">dodge_var</span><span class="op">)</span></span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/Box_plot_strat-2.png" width="768" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span></span>
<span><span class="va">x_var</span> <span class="op">&lt;-</span> <span class="st">"Cell_Of_Origin"</span></span>
<span><span class="va">y_var</span> <span class="op">&lt;-</span> <span class="st">"GeneA"</span></span>
<span></span>
<span></span>
<span><span class="va">strat1_var</span> <span class="op">=</span> <span class="st">"Treatment_Arm"</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_box_plot_core.html">wrapper_box_plot_core_strat</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, x_var <span class="op">=</span> <span class="va">x_var</span>, y_var <span class="op">=</span> <span class="va">y_var</span>, strat1_var <span class="op">=</span> <span class="va">strat1_var</span><span class="op">)</span></span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/Box_plot_strat-3.png" width="768" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="complex-boxplot">Complex boxplot<a class="anchor" aria-label="anchor" href="#complex-boxplot"></a>
</h2>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span><span class="va">y_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GeneA"</span>, <span class="st">"GeneB"</span>, <span class="st">"GeneC"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_box_plot_yvars_core_strat.html">wrapper_box_plot_yvars_core_strat</a></span><span class="op">(</span><span class="va">data</span>, y_vars <span class="op">=</span> <span class="va">y_vars</span><span class="op">)</span></span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/complex_boxplot-1.png" width="960" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span><span class="va">y_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GeneA"</span>, <span class="st">"GeneB"</span>, <span class="st">"GeneC"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">x_var</span> <span class="op">=</span> <span class="st">"Cell_Of_Origin"</span></span>
<span><span class="va">facet_var</span> <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="va">dodge_var</span> <span class="op">=</span> <span class="cn">NULL</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_box_plot_yvars_core_strat.html">wrapper_box_plot_yvars_core_strat</a></span><span class="op">(</span><span class="va">data</span>, y_vars <span class="op">=</span> <span class="va">y_vars</span>, x_var <span class="op">=</span> <span class="va">x_var</span>, facet_var <span class="op">=</span> <span class="va">facet_var</span>,</span>
<span>    dodge_var <span class="op">=</span> <span class="va">dodge_var</span><span class="op">)</span></span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/complex_boxplot-2.png" width="960" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span><span class="va">y_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GeneA"</span>, <span class="st">"GeneB"</span>, <span class="st">"GeneC"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">x_var</span> <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="va">facet_var</span> <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="va">dodge_var</span> <span class="op">=</span> <span class="st">"Cell_Of_Origin"</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_box_plot_yvars_core_strat.html">wrapper_box_plot_yvars_core_strat</a></span><span class="op">(</span><span class="va">data</span>, y_vars <span class="op">=</span> <span class="va">y_vars</span>, x_var <span class="op">=</span> <span class="va">x_var</span>, facet_var <span class="op">=</span> <span class="va">facet_var</span>,</span>
<span>    dodge_var <span class="op">=</span> <span class="va">dodge_var</span><span class="op">)</span></span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/complex_boxplot-3.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="kruskalwallis-h-test">Kruskal–Wallis H test<a class="anchor" aria-label="anchor" href="#kruskalwallis-h-test"></a>
</h2>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span></span>
<span><span class="va">cat_vars</span> <span class="op">&lt;-</span> <span class="st">"Cell_Of_Origin"</span></span>
<span><span class="va">num_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GeneA"</span>, <span class="st">"GeneB"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_kruskal_test.html">wrapper_kruskal_test</a></span><span class="op">(</span><span class="va">data</span>, num_vars <span class="op">=</span> <span class="va">num_vars</span>, cat_vars <span class="op">=</span> <span class="va">cat_vars</span><span class="op">)</span></span></code></pre></div>
<table class="table table table-condensed table-bordered" style="font-size: 9px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Kruskal-Wallis H test.
</caption>
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="2">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Cell Of Origin
</div>
</th>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="2">
</th>
</tr>
<tr>
<th style="text-align:left;">
Covariate
</th>
<th style="text-align:left;">
Statistic
</th>
<th style="text-align:left;">
GCB
</th>
<th style="text-align:left;">
UNCLASSIFIED
</th>
<th style="text-align:left;">
ABC
</th>
<th style="text-align:left;">
P-value
</th>
<th style="text-align:left;">
Adj. P-value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
GeneA
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
N
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
218
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
62
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
111
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.0265 *
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.0440 *
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
Median
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
7.95
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
8.53
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
7.98
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
</tr>
<tr>
<td style="text-align:left;">
GeneB
</td>
<td style="text-align:left;">
N
</td>
<td style="text-align:left;">
218
</td>
<td style="text-align:left;">
62
</td>
<td style="text-align:left;">
111
</td>
<td style="text-align:left;font-weight: bold;">
0.0440 *
</td>
<td style="text-align:left;font-weight: bold;">
0.0440 *
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Median
</td>
<td style="text-align:left;">
7.92
</td>
<td style="text-align:left;">
8.10
</td>
<td style="text-align:left;">
8.12
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/wrapper_kruskal_test.html">wrapper_kruskal_test</a></span><span class="op">(</span><span class="va">data</span>, num_vars <span class="op">=</span> <span class="va">num_vars</span>, cat_vars <span class="op">=</span> <span class="va">cat_vars</span>, print_pvalues <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<table class="table table table-condensed table-bordered" style="font-size: 9px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Kruskal-Wallis H test.
</caption>
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="2">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Cell Of Origin
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Covariate
</th>
<th style="text-align:left;">
Statistic
</th>
<th style="text-align:left;">
GCB
</th>
<th style="text-align:left;">
UNCLASSIFIED
</th>
<th style="text-align:left;">
ABC
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
GeneA
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
N
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
218
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
62
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
111
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
Median
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
7.95
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
8.53
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
7.98
</td>
</tr>
<tr>
<td style="text-align:left;">
GeneB
</td>
<td style="text-align:left;">
N
</td>
<td style="text-align:left;">
218
</td>
<td style="text-align:left;">
62
</td>
<td style="text-align:left;">
111
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Median
</td>
<td style="text-align:left;">
7.92
</td>
<td style="text-align:left;">
8.10
</td>
<td style="text-align:left;">
8.12
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span></span>
<span><span class="va">cat_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Cell_Of_Origin"</span>, <span class="st">"IPI"</span>, <span class="st">"Treatment_Arm"</span><span class="op">)</span></span>
<span><span class="va">num_vars</span> <span class="op">&lt;-</span> <span class="st">"GeneA"</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_kruskal_test.html">wrapper_kruskal_test</a></span><span class="op">(</span><span class="va">data</span>, num_vars <span class="op">=</span> <span class="va">num_vars</span>, cat_vars <span class="op">=</span> <span class="va">cat_vars</span><span class="op">)</span></span></code></pre></div>
<table class="table table table-condensed table-bordered" style="font-size: 9px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Kruskal-Wallis H test.
</caption>
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="2">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
GeneA
</div>
</th>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="3">
</th>
</tr>
<tr>
<th style="text-align:left;">
Covariate
</th>
<th style="text-align:left;">
Subgroup
</th>
<th style="text-align:left;">
N
</th>
<th style="text-align:left;">
Median
</th>
<th style="text-align:left;">
Difference
</th>
<th style="text-align:left;">
P-value
</th>
<th style="text-align:left;">
Adj. P-value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
Cell Of Origin
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
GCB
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
218
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
7.95
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
NA
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.0265 *
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.0794 .
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
UNCLASSIFIED
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
62
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
8.53
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
ABC
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
111
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
7.98
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
</tr>
<tr>
<td style="text-align:left;">
IPI
</td>
<td style="text-align:left;">
Low
</td>
<td style="text-align:left;">
79
</td>
<td style="text-align:left;">
7.87
</td>
<td style="text-align:left;font-weight: bold;">
NA
</td>
<td style="text-align:left;font-weight: bold;">
0.0867 .
</td>
<td style="text-align:left;font-weight: bold;">
0.1301
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Low-Intermediate
</td>
<td style="text-align:left;">
147
</td>
<td style="text-align:left;">
7.93
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
High-Intermediate
</td>
<td style="text-align:left;">
108
</td>
<td style="text-align:left;">
8.29
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
High
</td>
<td style="text-align:left;">
66
</td>
<td style="text-align:left;">
7.90
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
<td style="text-align:left;font-weight: bold;">
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
Treatment Arm
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
CTRL
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
204
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
7.98
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.06
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.9043
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
0.9043
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
TRT
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
196
</td>
<td style="text-align:left;background-color: rgba(242, 244, 244, 255) !important;">
8.03
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(242, 244, 244, 255) !important;">
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="point-plot">Point plot<a class="anchor" aria-label="anchor" href="#point-plot"></a>
</h2>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span></span>
<span><span class="va">x_var</span> <span class="op">&lt;-</span> <span class="st">"GeneA"</span></span>
<span><span class="va">y_var</span> <span class="op">&lt;-</span> <span class="st">"GeneB"</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_point_plot_core.html">wrapper_point_plot_core</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, x_var <span class="op">=</span> <span class="va">x_var</span>, y_var <span class="op">=</span> <span class="va">y_var</span><span class="op">)</span></span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/Point_plot-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="section level3">
<h3 id="stratified-2">Stratified<a class="anchor" aria-label="anchor" href="#stratified-2"></a>
</h3>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span></span>
<span><span class="va">x_var</span> <span class="op">&lt;-</span> <span class="st">"GeneA"</span></span>
<span><span class="va">y_var</span> <span class="op">&lt;-</span> <span class="st">"GeneB"</span></span>
<span><span class="va">facet_var</span> <span class="op">&lt;-</span> <span class="st">"Treatment_Arm"</span></span>
<span><span class="va">color_point_var</span> <span class="op">&lt;-</span> <span class="st">"Cell_Of_Origin"</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_point_plot_core.html">wrapper_point_plot_core</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, x_var <span class="op">=</span> <span class="va">x_var</span>, y_var <span class="op">=</span> <span class="va">y_var</span>, facet_var <span class="op">=</span> <span class="va">facet_var</span>,</span>
<span>    color_point_var <span class="op">=</span> <span class="va">color_point_var</span><span class="op">)</span></span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/Point_plot_strat-1.png" width="1152" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span></span>
<span><span class="va">x_var</span> <span class="op">&lt;-</span> <span class="st">"GeneD"</span></span>
<span><span class="va">y_var</span> <span class="op">&lt;-</span> <span class="st">"GeneB"</span></span>
<span><span class="va">facet_var</span> <span class="op">&lt;-</span> <span class="st">"Treatment_Arm"</span></span>
<span><span class="va">strat1_var</span> <span class="op">&lt;-</span> <span class="st">"Cell_Of_Origin"</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_point_plot_core.html">wrapper_point_plot_core_strat</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, x_var <span class="op">=</span> <span class="va">x_var</span>, y_var <span class="op">=</span> <span class="va">y_var</span>, facet_var <span class="op">=</span> <span class="va">facet_var</span>,</span>
<span>    strat1_var <span class="op">=</span> <span class="va">strat1_var</span><span class="op">)</span></span></code></pre></div>
<p><img src="Exploratory_Biomarker_Analysis_files/figure-html/Point_plot_strat-2.png" width="1152" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="characteristics-of-itt-and-bep">Characteristics of ITT and BEP<a class="anchor" aria-label="anchor" href="#characteristics-of-itt-and-bep"></a>
</h2>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">bdata</span></span>
<span></span>
<span><span class="va">strat_var</span> <span class="op">&lt;-</span> <span class="st">"Treatment_Arm"</span></span>
<span><span class="va">covariate_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Age"</span>, <span class="st">"IPI"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_characteristics_core.html">wrapper_characteristics_core</a></span><span class="op">(</span><span class="va">data</span>, strat_var <span class="op">=</span> <span class="va">strat_var</span>, covariate_vars <span class="op">=</span> <span class="va">covariate_vars</span><span class="op">)</span></span></code></pre></div>
<table class="table table table-condensed table-bordered" style="font-size: 9px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Treatment Arm
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Covariate
</th>
<th style="text-align:left;">
CTRL
</th>
<th style="text-align:left;">
TRT
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;background-color: rgba(215, 236, 255, 255) !important;">
Age
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(215, 236, 255, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(215, 236, 255, 255) !important;">
</td>
</tr>
<tr>
<td style="text-align:left;color: rgba(102, 102, 102, 255) !important;background-color: rgba(240, 248, 255, 255) !important;">
N
</td>
<td style="text-align:left;color: rgba(102, 102, 102, 255) !important;background-color: rgba(240, 248, 255, 255) !important;">
252
</td>
<td style="text-align:left;color: rgba(102, 102, 102, 255) !important;background-color: rgba(240, 248, 255, 255) !important;">
248
</td>
</tr>
<tr>
<td style="text-align:left;color: rgba(102, 102, 102, 255) !important;background-color: rgba(240, 248, 255, 255) !important;">
NAs
</td>
<td style="text-align:left;color: rgba(102, 102, 102, 255) !important;background-color: rgba(240, 248, 255, 255) !important;">
0
</td>
<td style="text-align:left;color: rgba(102, 102, 102, 255) !important;background-color: rgba(240, 248, 255, 255) !important;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Median
</td>
<td style="text-align:left;">
63.00
</td>
<td style="text-align:left;">
63.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Mean
</td>
<td style="text-align:left;">
60.73
</td>
<td style="text-align:left;">
61.05
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;background-color: rgba(215, 236, 255, 255) !important;">
IPI
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(215, 236, 255, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(215, 236, 255, 255) !important;">
</td>
</tr>
<tr>
<td style="text-align:left;color: rgba(102, 102, 102, 255) !important;background-color: rgba(240, 248, 255, 255) !important;">
N
</td>
<td style="text-align:left;color: rgba(102, 102, 102, 255) !important;background-color: rgba(240, 248, 255, 255) !important;">
252
</td>
<td style="text-align:left;color: rgba(102, 102, 102, 255) !important;background-color: rgba(240, 248, 255, 255) !important;">
248
</td>
</tr>
<tr>
<td style="text-align:left;color: rgba(102, 102, 102, 255) !important;background-color: rgba(240, 248, 255, 255) !important;">
NAs
</td>
<td style="text-align:left;color: rgba(102, 102, 102, 255) !important;background-color: rgba(240, 248, 255, 255) !important;">
0
</td>
<td style="text-align:left;color: rgba(102, 102, 102, 255) !important;background-color: rgba(240, 248, 255, 255) !important;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Low
</td>
<td style="text-align:left;">
52 (20.63%)
</td>
<td style="text-align:left;">
48 (19.35%)
</td>
</tr>
<tr>
<td style="text-align:left;">
Low-Intermediate
</td>
<td style="text-align:left;">
95 (37.70%)
</td>
<td style="text-align:left;">
88 (35.48%)
</td>
</tr>
<tr>
<td style="text-align:left;">
High-Intermediate
</td>
<td style="text-align:left;">
71 (28.17%)
</td>
<td style="text-align:left;">
64 (25.81%)
</td>
</tr>
<tr>
<td style="text-align:left;">
High
</td>
<td style="text-align:left;">
34 (13.49%)
</td>
<td style="text-align:left;">
48 (19.35%)
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bep_vars</span> <span class="op">&lt;-</span> <span class="st">"BEP_RNAseq"</span></span>
<span><span class="va">covariate_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Age"</span>, <span class="st">"IPI"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">treatment_var</span> <span class="op">&lt;-</span> <span class="st">"Treatment_Arm"</span></span>
<span><span class="va">itt_name</span> <span class="op">=</span> <span class="st">"ITT"</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/wrapper_characteristics_bep.html">wrapper_characteristics_bep</a></span><span class="op">(</span><span class="va">data</span>, covariate_vars <span class="op">=</span> <span class="va">covariate_vars</span>, bep_vars <span class="op">=</span> <span class="va">bep_vars</span>,</span>
<span>    treatment_var <span class="op">=</span> <span class="va">treatment_var</span>, itt_name <span class="op">=</span> <span class="va">itt_name</span><span class="op">)</span></span></code></pre></div>
<table class="table table table-condensed table-bordered" style="font-size: 9px; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
Covariate
</th>
<th style="text-align:left;">
ITT
</th>
<th style="text-align:left;">
ITT : CTRL
</th>
<th style="text-align:left;">
ITT : TRT
</th>
<th style="text-align:left;">
BEP RNAseq
</th>
<th style="text-align:left;">
BEP RNAseq : CTRL
</th>
<th style="text-align:left;">
BEP RNAseq : TRT
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;background-color: rgba(215, 236, 255, 255) !important;">
Age
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(215, 236, 255, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(215, 236, 255, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(215, 236, 255, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(215, 236, 255, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(215, 236, 255, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(215, 236, 255, 255) !important;">
</td>
</tr>
<tr>
<td style="text-align:left;color: rgba(102, 102, 102, 255) !important;background-color: rgba(240, 248, 255, 255) !important;">
N
</td>
<td style="text-align:left;color: rgba(102, 102, 102, 255) !important;background-color: rgba(240, 248, 255, 255) !important;">
500
</td>
<td style="text-align:left;color: rgba(102, 102, 102, 255) !important;background-color: rgba(240, 248, 255, 255) !important;">
252
</td>
<td style="text-align:left;color: rgba(102, 102, 102, 255) !important;background-color: rgba(240, 248, 255, 255) !important;">
248
</td>
<td style="text-align:left;color: rgba(102, 102, 102, 255) !important;background-color: rgba(240, 248, 255, 255) !important;">
400
</td>
<td style="text-align:left;color: rgba(102, 102, 102, 255) !important;background-color: rgba(240, 248, 255, 255) !important;">
204
</td>
<td style="text-align:left;color: rgba(102, 102, 102, 255) !important;background-color: rgba(240, 248, 255, 255) !important;">
196
</td>
</tr>
<tr>
<td style="text-align:left;color: rgba(102, 102, 102, 255) !important;background-color: rgba(240, 248, 255, 255) !important;">
NAs
</td>
<td style="text-align:left;color: rgba(102, 102, 102, 255) !important;background-color: rgba(240, 248, 255, 255) !important;">
0
</td>
<td style="text-align:left;color: rgba(102, 102, 102, 255) !important;background-color: rgba(240, 248, 255, 255) !important;">
0
</td>
<td style="text-align:left;color: rgba(102, 102, 102, 255) !important;background-color: rgba(240, 248, 255, 255) !important;">
0
</td>
<td style="text-align:left;color: rgba(102, 102, 102, 255) !important;background-color: rgba(240, 248, 255, 255) !important;">
0
</td>
<td style="text-align:left;color: rgba(102, 102, 102, 255) !important;background-color: rgba(240, 248, 255, 255) !important;">
0
</td>
<td style="text-align:left;color: rgba(102, 102, 102, 255) !important;background-color: rgba(240, 248, 255, 255) !important;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Median
</td>
<td style="text-align:left;">
63.00
</td>
<td style="text-align:left;">
63.00
</td>
<td style="text-align:left;">
63.00
</td>
<td style="text-align:left;">
63.00
</td>
<td style="text-align:left;">
63.00
</td>
<td style="text-align:left;">
63.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Mean
</td>
<td style="text-align:left;">
60.89
</td>
<td style="text-align:left;">
60.73
</td>
<td style="text-align:left;">
61.05
</td>
<td style="text-align:left;">
61.71
</td>
<td style="text-align:left;">
61.50
</td>
<td style="text-align:left;">
61.93
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;background-color: rgba(215, 236, 255, 255) !important;">
IPI
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(215, 236, 255, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(215, 236, 255, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(215, 236, 255, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(215, 236, 255, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(215, 236, 255, 255) !important;">
</td>
<td style="text-align:left;font-weight: bold;background-color: rgba(215, 236, 255, 255) !important;">
</td>
</tr>
<tr>
<td style="text-align:left;color: rgba(102, 102, 102, 255) !important;background-color: rgba(240, 248, 255, 255) !important;">
N
</td>
<td style="text-align:left;color: rgba(102, 102, 102, 255) !important;background-color: rgba(240, 248, 255, 255) !important;">
500
</td>
<td style="text-align:left;color: rgba(102, 102, 102, 255) !important;background-color: rgba(240, 248, 255, 255) !important;">
252
</td>
<td style="text-align:left;color: rgba(102, 102, 102, 255) !important;background-color: rgba(240, 248, 255, 255) !important;">
248
</td>
<td style="text-align:left;color: rgba(102, 102, 102, 255) !important;background-color: rgba(240, 248, 255, 255) !important;">
400
</td>
<td style="text-align:left;color: rgba(102, 102, 102, 255) !important;background-color: rgba(240, 248, 255, 255) !important;">
204
</td>
<td style="text-align:left;color: rgba(102, 102, 102, 255) !important;background-color: rgba(240, 248, 255, 255) !important;">
196
</td>
</tr>
<tr>
<td style="text-align:left;color: rgba(102, 102, 102, 255) !important;background-color: rgba(240, 248, 255, 255) !important;">
NAs
</td>
<td style="text-align:left;color: rgba(102, 102, 102, 255) !important;background-color: rgba(240, 248, 255, 255) !important;">
0
</td>
<td style="text-align:left;color: rgba(102, 102, 102, 255) !important;background-color: rgba(240, 248, 255, 255) !important;">
0
</td>
<td style="text-align:left;color: rgba(102, 102, 102, 255) !important;background-color: rgba(240, 248, 255, 255) !important;">
0
</td>
<td style="text-align:left;color: rgba(102, 102, 102, 255) !important;background-color: rgba(240, 248, 255, 255) !important;">
0
</td>
<td style="text-align:left;color: rgba(102, 102, 102, 255) !important;background-color: rgba(240, 248, 255, 255) !important;">
0
</td>
<td style="text-align:left;color: rgba(102, 102, 102, 255) !important;background-color: rgba(240, 248, 255, 255) !important;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Low
</td>
<td style="text-align:left;">
100 (20.00%)
</td>
<td style="text-align:left;">
52 (20.63%)
</td>
<td style="text-align:left;">
48 (19.35%)
</td>
<td style="text-align:left;">
79 (19.75%)
</td>
<td style="text-align:left;">
44 (21.57%)
</td>
<td style="text-align:left;">
35 (17.86%)
</td>
</tr>
<tr>
<td style="text-align:left;">
Low-Intermediate
</td>
<td style="text-align:left;">
183 (36.60%)
</td>
<td style="text-align:left;">
95 (37.70%)
</td>
<td style="text-align:left;">
88 (35.48%)
</td>
<td style="text-align:left;">
147 (36.75%)
</td>
<td style="text-align:left;">
73 (35.78%)
</td>
<td style="text-align:left;">
74 (37.76%)
</td>
</tr>
<tr>
<td style="text-align:left;">
High-Intermediate
</td>
<td style="text-align:left;">
135 (27.00%)
</td>
<td style="text-align:left;">
71 (28.17%)
</td>
<td style="text-align:left;">
64 (25.81%)
</td>
<td style="text-align:left;">
108 (27.00%)
</td>
<td style="text-align:left;">
59 (28.92%)
</td>
<td style="text-align:left;">
49 (25.00%)
</td>
</tr>
<tr>
<td style="text-align:left;">
High
</td>
<td style="text-align:left;">
82 (16.40%)
</td>
<td style="text-align:left;">
34 (13.49%)
</td>
<td style="text-align:left;">
48 (19.35%)
</td>
<td style="text-align:left;">
66 (16.50%)
</td>
<td style="text-align:left;">
28 (13.73%)
</td>
<td style="text-align:left;">
38 (19.39%)
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.4.1 (2024-06-14)</span></span>
<span><span class="co">## Platform: x86_64-apple-darwin20</span></span>
<span><span class="co">## Running under: macOS Sonoma 14.6.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /Library/Frameworks/R.framework/Versions/4.4-x86_64/Resources/lib/libRblas.0.dylib </span></span>
<span><span class="co">## LAPACK: /Library/Frameworks/R.framework/Versions/4.4-x86_64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: Europe/Zurich</span></span>
<span><span class="co">## tzcode source: internal</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] BiomarkerWrappers_0.0.0.60 ggplot2_3.5.1             </span></span>
<span><span class="co">## [3] kableExtra_1.4.0           rmarkdown_2.27            </span></span>
<span><span class="co">## [5] knitr_1.47                </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##   [1] polynom_1.4-1         gridExtra_2.3         formatR_1.14         </span></span>
<span><span class="co">##   [4] rlang_1.1.4           magrittr_2.0.3        clue_0.3-65          </span></span>
<span><span class="co">##   [7] GetoptLong_1.0.5      matrixStats_1.3.0     compiler_4.4.1       </span></span>
<span><span class="co">##  [10] png_0.1-8             systemfonts_1.1.0     vctrs_0.6.5          </span></span>
<span><span class="co">##  [13] stringr_1.5.1         pkgconfig_2.0.3       shape_1.4.6.1        </span></span>
<span><span class="co">##  [16] crayon_1.5.3          fastmap_1.2.0         backports_1.5.0      </span></span>
<span><span class="co">##  [19] labeling_0.4.3        KMsurv_0.1-5          utf8_1.2.4           </span></span>
<span><span class="co">##  [22] markdown_1.13         forestplot_3.1.3      ggbeeswarm_0.7.2     </span></span>
<span><span class="co">##  [25] ragg_1.3.2            purrr_1.0.2           xfun_0.45            </span></span>
<span><span class="co">##  [28] cachem_1.1.0          jsonlite_1.8.8        highr_0.11           </span></span>
<span><span class="co">##  [31] broom_1.0.6           parallel_4.4.1        cluster_2.1.6        </span></span>
<span><span class="co">##  [34] R6_2.5.1              bslib_0.7.0           stringi_1.8.4        </span></span>
<span><span class="co">##  [37] RColorBrewer_1.1-3    limma_3.60.3          car_3.1-2            </span></span>
<span><span class="co">##  [40] jquerylib_0.1.4       Rcpp_1.0.12           iterators_1.0.14     </span></span>
<span><span class="co">##  [43] zoo_1.8-12            IRanges_2.38.0        Matrix_1.7-0         </span></span>
<span><span class="co">##  [46] splines_4.4.1         tidyselect_1.2.1      rstudioapi_0.16.0    </span></span>
<span><span class="co">##  [49] abind_1.4-5           yaml_2.3.8            ggtext_0.1.2         </span></span>
<span><span class="co">##  [52] doParallel_1.0.17     codetools_0.2-20      lattice_0.22-6       </span></span>
<span><span class="co">##  [55] tibble_3.2.1          plyr_1.8.9            withr_3.0.0          </span></span>
<span><span class="co">##  [58] evaluate_0.24.0       desc_1.4.3            survival_3.7-0       </span></span>
<span><span class="co">##  [61] ggpp_0.5.8            xml2_1.3.6            circlize_0.4.16      </span></span>
<span><span class="co">##  [64] survMisc_0.5.6        pillar_1.9.0          ggpubr_0.6.0         </span></span>
<span><span class="co">##  [67] carData_3.0-5         checkmate_2.3.1       foreach_1.5.2        </span></span>
<span><span class="co">##  [70] stats4_4.4.1          generics_0.1.3        S4Vectors_0.42.0     </span></span>
<span><span class="co">##  [73] commonmark_1.9.1      munsell_0.5.1         scales_1.3.0         </span></span>
<span><span class="co">##  [76] xtable_1.8-4          glue_1.7.0            survminer_0.4.9      </span></span>
<span><span class="co">##  [79] tools_4.4.1           data.table_1.15.4     ggsignif_0.6.4       </span></span>
<span><span class="co">##  [82] fs_1.6.4              cowplot_1.1.3         grid_4.4.1           </span></span>
<span><span class="co">##  [85] tidyr_1.3.1           colorspace_2.1-0      beeswarm_0.4.0       </span></span>
<span><span class="co">##  [88] vipor_0.4.7           cli_3.6.3             km.ci_0.5-6          </span></span>
<span><span class="co">##  [91] textshaping_0.4.0     fansi_1.0.6           viridisLite_0.4.2    </span></span>
<span><span class="co">##  [94] svglite_2.1.3         ComplexHeatmap_2.20.0 dplyr_1.1.4          </span></span>
<span><span class="co">##  [97] gtable_0.3.5          rstatix_0.7.2         sass_0.4.9           </span></span>
<span><span class="co">## [100] digest_0.6.36         BiocGenerics_0.50.0   rjson_0.2.21         </span></span>
<span><span class="co">## [103] htmlwidgets_1.6.4     farver_2.1.2          memoise_2.0.1        </span></span>
<span><span class="co">## [106] htmltools_0.5.8.1     pkgdown_2.0.9         lifecycle_1.0.4      </span></span>
<span><span class="co">## [109] GlobalOptions_0.1.2   statmod_1.5.0         gridtext_0.1.5       </span></span>
<span><span class="co">## [112] MASS_7.3-61</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Malgorzata Nowicka.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
